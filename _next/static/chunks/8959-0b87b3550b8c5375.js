"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8959],{63499:function(e,t,n){n.d(t,{x:function(){return s}});var r=n(83904),o=n(85388),a=n(59630),s=(0,r.m$)(o.E.div,{shouldForwardProp:function(e){return(0,a.Z)(e)||"children"===e}});(0,r.m$)(o.E.button,{shouldForwardProp:function(e){return(0,a.Z)(e)||"children"===e}})},47300:function(e,t,n){n.d(t,{W:function(){return l}});var r=n(26042),o=n(69396),a=n(99534),s=n(85893),i=n(80016),u=n(27605),c=n(57438),p=n(13510);function l(e){var t=e.buttonText,n=(0,a.Z)(e,["buttonText"]),l=function(){var e=(0,c.H)(),t=(0,p.q)().userAddress,n=(0,u.lC)({config:(0,o.Z)((0,r.Z)({},u.Q_),{functionName:"setRelayerApproval"}),transactionType:"APPROVE"}),s=n.submit,i=(n.submitAsync,(0,a.Z)(n,["submit","submitAsync"]));return(0,r.Z)({approve:function(){s({args:[t,e.balancer.batchRelayer,!0],toastText:"Approve Batch Relayer"})}},i)}(),d=l.approve,f=(0,a.Z)(l,["approve"]);return(0,s.jsx)(i.H,(0,o.Z)((0,r.Z)((0,o.Z)((0,r.Z)({},f),{width:"full",onClick:function(){d()}}),n),{borderColor:"beets.green",_focus:{boxShadow:"none"},submittingText:"Confirm...",pendingText:"Waiting...",children:t||"Approve Batch Relayer"}))}},97573:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(26042),o=n(69396),a=n(99534),s=n(85893),i=n(47741),u=n(48641),c=n(67294),p=n(78268),l=n(63499);function d(e){var t=e.onClose,n=e.title,d=e.children,f=e.animate,m=e.initial,h=e.exit,v=e.topRight,k=e.titleProps,x=(0,a.Z)(e,["onClose","title","children","animate","initial","exit","topRight","titleProps"]),S=(0,c.useMemo)((function(){return(0,s.jsxs)(u.kC,(0,o.Z)((0,r.Z)({justifyContent:"space-between",width:"full",padding:"4",alignItems:"center",position:"relative"},k),{children:[(0,s.jsx)(u.xv,{fontWeight:"semibold",fontSize:"xl",color:"beets.base.50",children:n}),t&&(0,s.jsx)(i.zx,{position:"absolute",height:"fit-content",onClick:t,borderRadius:"full",variant:"ghost",color:"gray.200",_hover:{color:"beets.red.300"},_active:{backgroundColor:"gray.300"},_focus:{outline:"none"},padding:"2",right:".5rem",children:(0,s.jsx)(p.Z,{size:24})}),v]}))}),[n,t,v]);return(0,s.jsxs)(l.x,(0,o.Z)((0,r.Z)({animate:f,initial:m,exit:h,rounded:"lg",backgroundColor:"box.500",border:"1px",borderColor:"blackAlpha.400",display:"flex",flexDirection:"column"},x),{children:[n&&S,d]}))}},10679:function(e,t,n){n.d(t,{G:function(){return m}});var r=n(26042),o=n(69396),a=n(99534),s=n(85893),i=n(83904),u=n(48641),c=n(97026),p=n(35610),l=n(3557),d=n(46445),f=n(67294);function m(e){var t=e.steps,n=(0,a.Z)(e,["steps"]),m=(0,i.Fg)();return(0,s.jsx)(u.kC,(0,o.Z)((0,r.Z)({justifyContent:"center"},n),{children:(0,s.jsx)(u.Ug,{spacing:"0",children:t.map((function(e,n){var r=e.status,o=e.tooltipText;return(0,s.jsxs)(f.Fragment,{children:[(0,s.jsx)(c.u,{label:o,children:"pending"===r?(0,s.jsxs)(u.xu,{position:"relative",height:"30px",width:"30px",children:[(0,s.jsx)(p.$,{thickness:"2px",speed:"0.65s",emptyColor:"orange.400",color:"orange.600",size:"lg",height:"30px",width:"30px"}),(0,s.jsx)(u.M5,{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",fontWeight:"bold",color:"orange.400",children:n+1})]}):(0,s.jsx)(u.Cd,{size:"30px",borderWidth:1,borderColor:"idle"===r?"gray.300":"complete"===r?"beets.green":"beets.highlight",color:"idle"===r?"gray.100":"beets.highlight",fontWeight:"idle"===r?"normal":"bold",cursor:"default",userSelect:"none",children:"submitting"===r?(0,s.jsx)(l.n,{stroke:m.colors.beets.highlight,boxSize:"16px",ml:"0.5"}):"complete"===r?(0,s.jsx)(d.Z,{size:"18",color:m.colors.beets.green}):n+1})}),n<t.length-1?(0,s.jsx)(u.xu,{height:"1px",width:t.length>5?"32px":"40px",bgColor:"gray.300"}):null]},"step-".concat(n))}))})}))}},8502:function(e,t,n){n.d(t,{T:function(){return h}});var r=n(26042),o=n(69396),a=n(85893),s=n(83904),i=n(89242),u=n(47741),c=n(48641),p=(n(67294),n(27434)),l=n(46445),d=n(86742),f=n(3784),m=n(17681);function h(e){var t=e.tokenOptions,n=e.selectedAddress,h=e.onOptionSelect,v=e.minimal,k=e.isWithdraw,x=(0,s.Fg)(),S=(0,m.pt)().getUserBalanceForToken,b=t.find((function(e){return e.address===n})),w=t.map((function(e){return(0,o.Z)((0,r.Z)({},e),{hasZeroBalance:"0.0"===S(e.address)})}));return(0,a.jsx)(i.v2,{children:function(e){var t=e.isOpen;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{label:"You can choose to use another, equivalent variant of this token.",children:(0,a.jsxs)(i.j2,{isActive:t,as:u.zx,rightIcon:(0,a.jsx)(c.kC,{backgroundColor:"whiteAlpha.200",rounded:"full",alignItems:"center",justifyContent:"center",p:"1",children:(0,a.jsx)(p.Z,{color:x.colors.beets.green})}),variant:"ghost",px:"1.5",minHeight:"50px",children:[v&&(0,a.jsxs)(c.Ug,{spacing:"1.5",flex:"1",children:[(0,a.jsx)(d.Z,{size:"xs",address:n}),(0,a.jsx)(c.xv,{children:null===b||void 0===b?void 0:b.symbol})]}),!v&&(0,a.jsxs)(c.Ug,{children:[(0,a.jsx)(d.Z,{width:"40px",height:"40px",address:n}),(0,a.jsxs)(c.gC,{spacing:"1",alignItems:"flex-start",children:[(0,a.jsx)(c.xv,{fontWeight:"normal",children:null===b||void 0===b?void 0:b.name}),(0,a.jsx)(c.Ug,{spacing:"1",children:(0,a.jsx)(c.xv,{fontWeight:"bold",children:null===b||void 0===b?void 0:b.symbol})})]})]})]})}),(0,a.jsx)(i.qy,{backgroundColor:"transparent",p:"0",children:(0,a.jsx)(c.xu,{py:"1",px:"1",backgroundColor:"blackAlpha.400",children:(0,a.jsx)(c.xu,{backgroundColor:"bg",children:(0,a.jsx)(c.xu,{backgroundColor:"blackAlpha.800",children:w.map((function(e){return(0,a.jsxs)(i.sN,{display:"flex",isDisabled:!k&&e.hasZeroBalance,onClick:function(){return h(e.address)},children:[(0,a.jsxs)(c.Ug,{spacing:"1.5",flex:"1",children:[(0,a.jsx)(d.Z,{width:"20px",height:"20px",address:e.address}),(0,a.jsx)(c.xv,{color:"gray.100",fontWeight:"normal",children:e.symbol})]}),e.address===n?(0,a.jsx)(l.Z,{}):null]},e.address)}))})})})})]})}})}},70570:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(85893),o=n(48641),a=n(20979),s=n(85388),i=(n(67294),n(51797)),u=n(57290),c=n(74590),p=n(48708),l=n(8502),d=n(86742);function f(e){var t=e.address,n=e.alternateTokens,f=void 0===n?[]:n,m=e.amount,h=e.withInput,v=e.selectedAlternateToken,k=void 0===v?"":v,x=e.onSelectedAlternateToken,S=e.onAmountChange,b=e.balance,w=(0,i.yA)(),y=w.getToken,T=w.priceForAmount,g=y(t.toLowerCase());return(0,r.jsxs)(o.Ug,{width:"full",justifyContent:"space-between",as:s.E.div,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[f.length>1?(0,r.jsx)(o.xu,{flex:"1",children:(0,r.jsx)(l.T,{tokenOptions:f,selectedAddress:k,onOptionSelect:function(e){x&&x(e)}})}):(0,r.jsxs)(o.Ug,{children:[(0,r.jsx)(d.Z,{width:"40px",height:"40px",address:t}),(0,r.jsxs)(o.xu,{children:[null===g||void 0===g?void 0:g.name,(0,r.jsx)(o.Ug,{spacing:"1",children:(0,r.jsx)(o.xv,{fontWeight:"bold",children:null===g||void 0===g?void 0:g.symbol})})]})]}),(0,r.jsxs)(o.gC,{alignItems:"flex-end",spacing:"0",children:[h&&(0,r.jsx)(a.II,{type:"number",min:0,placeholder:"0.0",textAlign:"right",value:m||"",onChange:function(e){!function(e){S&&S(e)}(e.currentTarget.value)},_hover:{borderColor:"gray.200"},_focus:{outline:"none"},_placeholder:{color:"gray.400"},color:"gray.100",borderColor:"transparent",border:"2px",bgColor:"blackAlpha.400",fontWeight:"semibold",onKeyDown:c.s,width:"full",pr:"1",pl:"2",height:"32px"}),!h&&(0,r.jsx)(o.xv,{children:(0,u.rY)(m)}),(0,r.jsx)(o.xv,{fontSize:"sm",color:"beets.base.100",children:(0,p.Rj)(T({address:t,amount:m}))}),b&&(0,r.jsxs)(o.xv,{fontSize:"sm",color:"gray.100",children:["You have ",(0,u.rY)(b||"0")]})]})]},"tokenrow-".concat(t))}},19149:function(e,t,n){n.d(t,{NP:function(){return te},dP:function(){return ee},Zs:function(){return X},tf:function(){return Q},ry:function(){return H},zI:function(){return V},R7:function(){return K},Cl:function(){return $}});var r=n(47568),o=n(51438),a=n(34051),s=n.n(a),i=n(20248),u=n(44431),c=n.n(u),p=n(27454),l=n(48694),d=n(72783),f=n(56371),m=n(20335),h=n(84868),v=n(52951),k=n(9279),x=function(){function e(t,n){(0,o.Z)(this,e),this.pool=t,this.wethAddress=n}var t=e.prototype;return t.updatePool=function(e){this.pool=e},t.scaleTokenAmountsTo18Decimals=function(e){var t=this;return this.pool.tokens.map((function(n){var r=e.find((function(e){return e.address===n.address}));return r&&r?t.scaleTo18AndApplyPriceRate(r):(0,p.RV)()}))},t.scaleTo18AndApplyPriceRate=function(e){var t=(0,l.GF)(e.address,this.pool.tokens),n=(0,p.cz)((0,f.parseUnits)(e.amount,18).toString()).times(t.priceRate).toFixed(0,c().ROUND_UP);return(0,p.cz)(n)},t.scaleTokenAmountDownFrom18Decimals=function(e,t,n){var r=(0,p.cz)(t).div(e.priceRate).toString(),o=(0,p.cz)(r).div((0,f.parseUnits)("1",18).toString()).toFixed(e.decimals,n),a=(0,f.parseUnits)(o,e.decimals);return(0,p.cz)(a.toString())},t.wethToZero=function(e){return(0,d.isSameAddress)(e,this.wethAddress)?k.d:e},(0,v.Z)(e,[{key:"totalSharesScaled",get:function(){return(0,p.SW)(this.pool.dynamicData.totalShares)}},{key:"swapFeeScaled",get:function(){return(0,p.SW)(this.pool.dynamicData.swapFee)}},{key:"tokenBalancesScaled",get:function(){return this.pool.tokens.map((function(e){return(0,p.SW)(e.balance,e.decimals)}))}},{key:"tokenWeightsScaled",get:function(){return this.pool.tokens.map((function(e){return(0,p.SW)(e.weight||"0",18)}))}},{key:"priceRatesScaled",get:function(){return this.pool.tokens.map((function(e){return(0,p.SW)(e.priceRate,18)}))}},{key:"ampScaled",get:function(){return"GqlPoolComposableStable"===this.pool.__typename||"GqlPoolStable"===this.pool.__typename||"GqlPoolMetaStable"===this.pool.__typename?(0,p.zb)((0,l.IW)(this.pool.amp)):(0,p.RV)()}},{key:"tokenBalancesScaledTo18Decimals",get:function(){var e=this;return this.pool.tokens.map((function(t){return e.scaleTo18AndApplyPriceRate({address:t.address,amount:t.balance})}))}}]),e}(),S=function(){function e(t,n,r){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.wethAddress=r,this.baseService=new x(t,r)}var t=e.prototype;return t.updatePool=function(e){this.baseService.updatePool(e),this.pool=e},t.joinGetProportionalSuggestionForFixedAmount=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.Uz)(e,n.pool.tokens));case 1:case"end":return t.stop()}}),t)})))()},t.joinGetBptOutAndPriceImpactForTokensIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){var r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=n.exactTokensInForBPTOut(e)).lt(0)){t.next=3;break}return t.abrupt("return",{priceImpact:0,minBptReceived:"0"});case 3:return o=n.bptForTokensZeroPriceImpact(e),t.abrupt("return",{priceImpact:(0,p.cz)(1).minus(r.div(o)).toNumber(),minBptReceived:(0,m.S5)(r.toString(),18)});case 5:case"end":return t.stop()}}),t)})))()},t.joinGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.pool.tokens.map((function(n){return e.wethIsEth?t.baseService.wethToZero(n.address):n.address})),i=(0,l.Xp)(e.maxAmountsIn,t.pool.tokens),u=t.encodeJoinPool(e),!("MASTER_CHEF"===(null===(r=t.pool.staking)||void 0===r?void 0:r.type)&&e.zapIntoMasterchefFarm||"GAUGE"===(null===(o=t.pool.staking)||void 0===o?void 0:o.type)&&e.zapIntoGauge)){n.next=6;break}return n.abrupt("return",t.batchRelayerService.encodeJoinPoolAndStake({userData:u,pool:t.pool,assets:a,maxAmountsIn:i,userAddress:e.userAddress}));case 6:return n.abrupt("return",{type:"JoinPool",assets:a,maxAmountsIn:i,userData:u});case 7:case"end":return n.stop()}}),n)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.OY)(e,n.pool.tokens,n.pool.dynamicData.totalShares,!0));case 1:case"end":return t.stop()}}),t)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.bptInForExactTokenOut(e),o=t.bptForTokensZeroPriceImpact([e]),n.abrupt("return",{bptIn:(0,m.S5)(r.toString(),18),priceImpact:r.div(o).minus(1).toNumber()});case 3:case"end":return n.stop()}}),n)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u,c;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=(0,p.zb)((0,f.parseUnits)(e)),a=(0,l.GF)(t,n.pool.tokens),i=n.exactBPTInForTokenOut(e,t),u=(0,m.S5)(i.toString(),a.decimals),c=n.bptForTokensZeroPriceImpact([{address:t,amount:u}]),r.abrupt("return",{tokenAmount:u,priceImpact:o.div(c).minus(1).toNumber()});case 6:case"end":return r.stop()}}),r)})))()},t.exitGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=e.kind,n.next="ExactBPTInForOneTokenOut"===n.t0?3:"ExactBPTInForTokensOut"===n.t0?6:8;break;case 3:return r=t.pool.tokens.find((function(t){return t.address===e.tokenOutAddress})),o=(0,p.yV)(e.amountOut,(null===r||void 0===r?void 0:r.decimals)||18,e.slippage),n.abrupt("return",{type:"ExitPool",assets:t.pool.tokens.map((function(e){return e.address})),minAmountsOut:(0,l.Xp)([{address:e.tokenOutAddress,amount:o}],t.pool.tokens),userData:t.encodeExitPool(e)});case 6:return a=e.amountsOut.map((function(n){var r=t.pool.tokens.find((function(e){return e.address===n.address}));return{address:n.address,amount:(0,p.yV)(n.amount,(null===r||void 0===r?void 0:r.decimals)||18,e.slippage)}})),n.abrupt("return",{type:"ExitPool",assets:t.pool.tokens.map((function(e){return e.address})),minAmountsOut:(0,l.Xp)(a,t.pool.tokens),userData:t.encodeExitPool(e)});case 8:throw new Error("unsupported exit");case 9:case"end":return n.stop()}}),n)})))()},t.bptForTokensZeroPriceImpact=function(e){var t=(0,l.Xp)(e,this.pool.tokens),n=this.pool.tokens.map((function(e){return(0,f.parseUnits)(e.balance,e.decimals)})),r=(0,d.stableBPTForTokensZeroPriceImpact)(n,this.pool.tokens.map((function(e){return e.decimals})),t,this.baseService.totalSharesScaled.toString(),this.baseService.ampScaled.toString());return(0,p.zb)(r)},t.exactTokensInForBPTOut=function(e){try{return i._E._calcBptOutGivenExactTokensIn(this.baseService.ampScaled,this.baseService.tokenBalancesScaledTo18Decimals,this.baseService.scaleTokenAmountsTo18Decimals(e),this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)}catch(t){return console.error(t),(0,p.RV)()}},t.bptInForExactTokensOut=function(e){return i._E._calcBptInGivenExactTokensOut(this.baseService.ampScaled,this.baseService.tokenBalancesScaledTo18Decimals,this.baseService.scaleTokenAmountsTo18Decimals(e),this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)},t.bptInForExactTokenOut=function(e){return i._E._calcBptInGivenExactTokensOut(this.baseService.ampScaled,this.baseService.tokenBalancesScaledTo18Decimals,this.baseService.scaleTokenAmountsTo18Decimals([e]),this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)},t.exactBPTInForTokenOut=function(e,t){if((0,p.cz)(e).eq(0))return(0,p.RV)();var n=(0,l.GF)(t,this.pool.tokens),r=(0,p.SW)(e),o=i._E._calcTokenOutGivenExactBptIn(this.baseService.ampScaled,this.baseService.tokenBalancesScaledTo18Decimals,n.index,r,this.baseService.totalSharesScaled,this.baseService.swapFeeScaled);return this.baseService.scaleTokenAmountDownFrom18Decimals(n,o,c().ROUND_DOWN)},t.encodeJoinPool=function(e){if("Init"==e.kind)return h.StablePoolEncoder.joinInit((0,l.Xp)(e.tokenAmountsIn,this.pool.tokens));if("ExactTokensInForBPTOut"==e.kind){var t=(0,p.yV)(e.minimumBpt,18,e.slippage);return h.StablePoolEncoder.joinExactTokensInForBPTOut((0,l.Xp)(e.tokenAmountsIn,this.pool.tokens),(0,f.parseUnits)(t,18))}if("TokenInForExactBPTOut"===e.kind){var n=(0,l.GF)(e.tokenInAddress,this.pool.tokens);return h.StablePoolEncoder.joinTokenInForExactBPTOut((0,f.parseUnits)(e.bptAmountOut),n.index)}throw new Error("unsupported join type")},t.encodeExitPool=function(e){if("ExactBPTInForOneTokenOut"==e.kind){var t=(0,l.GF)(e.tokenOutAddress,this.pool.tokens);return h.StablePoolEncoder.exitExactBPTInForOneTokenOut((0,f.parseUnits)(e.bptAmountIn),t.index)}if("ExactBPTInForTokensOut"==e.kind)return h.StablePoolEncoder.exitExactBPTInForTokensOut((0,f.parseUnits)(e.bptAmountIn));if("BPTInForExactTokensOut"===e.kind)return h.StablePoolEncoder.exitBPTInForExactTokensOut((0,l.Xp)(e.amountsOut,this.pool.tokens),(0,f.parseUnits)(e.maxBPTAmountIn));throw new Error("Unsupported exit type")},e}(),b=n(69407),w=n(26042),y=n(69396),T=n(29815);function g(e){var t=e.poolId,n=e.poolAddress,r=e.tokenAmountIn,o=e.poolToken,a=r.address.toLowerCase();if(o.address===a)return{swaps:[{poolId:t,assetInIndex:0,assetOutIndex:1,amount:(0,f.parseUnits)(r.amount,o.decimals).toString(),userData:"0x"}],assets:[a,n]};if("GqlPoolTokenLinear"===o.__typename){var s=o.pool.tokens.find((function(e){return e.address===a}));if(!s)throw new Error("Token does not exist in pool token: ".concat(a));return{swaps:[{poolId:o.pool.id,assetInIndex:0,assetOutIndex:1,amount:(0,f.parseUnits)(r.amount,s.decimals).toString(),userData:"0x"},{poolId:t,assetInIndex:1,assetOutIndex:2,amount:"0",userData:"0x"}],assets:[s.address,o.address,n]}}if("GqlPoolTokenComposableStable"===o.__typename){var i=A(a,o.pool.tokens);if(!i)throw new Error("Token does not exist in pool token: ".concat(a));var u=g({poolId:o.pool.id,poolAddress:o.pool.address,tokenAmountIn:r,poolToken:i}),c=u.swaps,p=u.assets;return{swaps:(0,T.Z)(c).concat([{poolId:t,assetInIndex:p.length-1,assetOutIndex:p.length,amount:"0",userData:"0x"}]),assets:(0,T.Z)(p).concat([n])}}throw new Error("No available join swap path for poolId: ".concat(t," and token: ").concat(a))}function I(e){var t=e.poolId,n=e.poolAddress,r=e.bptIn,o=e.poolToken,a=e.tokenOut,s=(0,f.parseUnits)(r,18).toString();if(o.address===a)return{swaps:[{poolId:t,assetInIndex:0,assetOutIndex:1,amount:s,userData:"0x"}],assets:[n,a]};if("GqlPoolTokenLinear"===o.__typename){var i=o.pool.tokens.find((function(e){return e.address===a}));if(!i)throw new Error("Token does not exist in pool token: ".concat(a));return{swaps:[{poolId:t,assetInIndex:0,assetOutIndex:1,amount:s,userData:"0x"},{poolId:o.pool.id,assetInIndex:1,assetOutIndex:2,amount:"0",userData:"0x"}],assets:[n,o.address,i.address]}}if("GqlPoolTokenComposableStable"===o.__typename){var u=A(a,o.pool.tokens);if(!u)throw new Error("Token does not exist in pool token: ".concat(a));var c=I({poolId:o.pool.id,poolAddress:o.pool.address,bptIn:"0",poolToken:u,tokenOut:a}),p=c.swaps,l=c.assets;return{swaps:[{poolId:t,assetInIndex:0,assetOutIndex:1,amount:s,userData:"0x"}].concat((0,T.Z)(p.map((function(e){return(0,y.Z)((0,w.Z)({},e),{assetInIndex:e.assetInIndex+1,assetOutIndex:e.assetOutIndex+1})})))),assets:[n].concat((0,T.Z)(l))}}throw new Error("No available join swap path for poolId: ".concat(t," and token: ").concat(a))}function P(e){return e.reduce((function(e,t){return e.plus((0,p.cz)(t.balance).times(t.priceRate))}),(0,p.cz)(0))}function A(e,t){var n=t.find((function(t){return"GqlPoolTokenLinear"===t.__typename?t.pool.tokens.find((function(t){return t.address===e})):t.address===e}));if(!n)throw new Error("No nested pool token find for token address: "+e);return n}function O(e,t,n){var r=!0,o=!1,a=void 0;try{for(var s,i=n[Symbol.iterator]();!(r=(s=i.next()).done);r=!0){var u=s.value,c=!0,p=!1,l=void 0;try{for(var f,m=u.tokenOptions[Symbol.iterator]();!(c=(f=m.next()).done);c=!0){var h=f.value;if((0,d.isSameAddress)(e,h.address)){var v=t.find((function(e){return e.index===u.poolTokenIndex}));if(v)return v}}}catch(k){p=!0,l=k}finally{try{c||null==m.return||m.return()}finally{if(p)throw l}}}}catch(k){o=!0,a=k}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}throw new Error("Token was not found in the provided options: ".concat(e))}var E,F=function(){function e(t,n,r,a){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.wethAddress=r,this.provider=a,this.baseService=new x(t,r)}var t=e.prototype;return t.updatePool=function(e){this.pool=e,this.baseService.updatePool(e)},t.joinGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,l;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("ExactTokensInForBPTOut"===e.kind){n.next=2;break}throw new Error("unsupported join type");case 2:return n.next=4,t.getJoinSwaps(e.tokenAmountsIn);case 4:return r=n.sent,o=r.swaps,a=r.assets,i=r.deltas,u=r.tokensIn,c=r.tokensOut,l=d.Swaps.getLimitsForSlippage(u,c,d.SwapType.SwapExactIn,i,a,"".concat((0,p.kx)(e.slippage,16).toFixed(0))).map((function(e){return e.toString()})),n.abrupt("return",{type:"BatchSwap",kind:h.SwapKind.GivenIn,swaps:o,assets:e.wethIsEth?a.map((function(e){return t.baseService.wethToZero(e)})):a,limits:l});case 12:case"end":return n.stop()}}),n)})))()},t.joinGetBptOutAndPriceImpactForTokensIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){var r,o,a,i,u,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getJoinSwaps(e);case 2:return r=t.sent,o=r.assets,a=r.deltas,u=(0,p.cz)(null!==(i=a[o.indexOf(n.pool.address)])&&void 0!==i?i:"0").abs(),c=n.bptForTokensZeroPriceImpact(e),t.abrupt("return",{priceImpact:c.lt(u)?0:(0,p.cz)(1).minus(u.div(c)).toNumber(),minBptReceived:(0,m.S5)(u.toString(),18)});case 9:case"end":return t.stop()}}),t)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){var r,o,a,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.getProportionallyWeightedBptAmountsForTokensOut(e),t.next=3,n.getExitSwaps(r);case 3:return o=t.sent,a=o.assets,i=o.deltas,t.abrupt("return",n.pool.withdrawConfig.options.map((function(e){var t=e.tokenOptions[0],n=a.findIndex((function(e){return(0,d.isSameAddress)(e,t.address)}));return{address:t.address,amount:(0,p.GR)((0,p.cz)(i[n]).abs(),t.decimals).toString()}})));case 7:case"end":return t.stop()}}),t)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getWithdrawOptionAndPoolTokenForTokenOut(e.address),r.poolToken,r.option,r.tokenOption,n.next=3,t.getJoinSwaps([e]);case 3:return o=n.sent,o.swaps,a=o.deltas,i=o.assets,u=i.findIndex((function(e){return(0,d.isSameAddress)(e,t.pool.address)})),c=(0,p.GR)((0,p.cz)(a[u]).abs(),18).toString(),n.abrupt("return",{priceImpact:0,bptIn:c});case 10:case"end":return n.stop()}}),n)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u,c,l;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=n.getWithdrawOptionAndPoolTokenForTokenOut(t).tokenOption,r.next=3,n.getExitSwaps([{address:t,amount:e}]);case 3:return a=r.sent,i=a.assets,u=a.deltas,c=i.findIndex((function(e){return(0,d.isSameAddress)(e,t)})),l=(0,p.GR)((0,p.cz)(u[c]).abs(),o.decimals).toString(),r.abrupt("return",{tokenAmount:l,priceImpact:0});case 9:case"end":return r.stop()}}),r)})))()},t.exitGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,p,l,d;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("ExactBPTInForTokensOut"!==e.kind){n.next=11;break}return r=t.getProportionallyWeightedBptAmountsForTokensOut(e.bptAmountIn),n.next=4,t.getExitSwaps(r);case 4:return o=n.sent,a=o.swaps,i=o.assets,u=o.deltas,n.abrupt("return",{type:"BatchSwap",kind:h.SwapKind.GivenIn,swaps:a,assets:i,limits:u});case 11:if("ExactBPTInForOneTokenOut"!==e.kind){n.next=19;break}return n.next=14,t.getExitSwaps([{address:e.tokenOutAddress,amount:e.bptAmountIn}]);case 14:return c=n.sent,p=c.swaps,l=c.assets,d=c.deltas,n.abrupt("return",{type:"BatchSwap",kind:h.SwapKind.GivenIn,swaps:p,assets:l,limits:d});case 19:throw new Error("unsupported join type");case 20:case"end":return n.stop()}}),n)})))()},t.bptForTokensZeroPriceImpact=function(e){var t=this.getDenormAmounts(e,this.pool.tokens),n=this.pool.tokens.map((function(e){return(0,f.parseUnits)(e.balance,e.decimals)})),r=this.pool.tokens.map((function(e){return e.decimals})),o=(0,b.phantomStableBPTForTokensZeroPriceImpact)(n,r,t,this.baseService.totalSharesScaled.toString(),this.baseService.ampScaled.toString(),this.baseService.swapFeeScaled.toString(),this.baseService.priceRatesScaled.map((function(e){return e.toString()})));return(0,p.zb)(o)},t.getJoinSwaps=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,p;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],o=e.map((function(e){var n=O(e.address,t.pool.tokens,t.pool.investConfig.options);return r.push(n.address),g({poolId:t.pool.id,poolAddress:t.pool.address,tokenAmountIn:e,poolToken:n})})),a=(0,l.Nu)(o.map((function(e){return e.assets})),o.map((function(e){return e.swaps}))),i=a.swaps,u=a.assets,n.next=5,(0,l.GR)({swapType:b.SwapTypes.SwapExactIn,swaps:i,assets:u,provider:t.provider});case 5:return c=n.sent,p=e.map((function(e){return e.address})),n.abrupt("return",{swaps:i,assets:u,deltas:c,tokensIn:p,tokensOut:r});case 8:case"end":return n.stop()}}),n)})))()},t.getExitSwaps=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.map((function(e){var n=O(e.address,t.pool.tokens,t.pool.withdrawConfig.options);return I({poolId:t.pool.id,poolAddress:t.pool.address,poolToken:n,tokenOut:e.address,bptIn:e.amount})})),o=(0,l.Nu)(r.map((function(e){return e.assets})),r.map((function(e){return e.swaps}))),a=o.swaps,i=o.assets,n.next=4,(0,l.GR)({swapType:b.SwapTypes.SwapExactIn,swaps:a,assets:i,provider:t.provider});case 4:return u=n.sent,n.abrupt("return",{swaps:a,assets:i,deltas:u});case 6:case"end":return n.stop()}}),n)})))()},t.getDenormAmounts=function(e,t){var n=this;return t.map((function(t){if("GqlPoolToken"===t.__typename){var r=e.find((function(e){return e.address===t.address}));return r?(0,f.parseUnits)(r.amount,t.decimals).toString():"0"}if("GqlPoolTokenLinear"===t.__typename){var o=t.pool,a=o.tokens.find((function(e){return e.index===o.mainIndex})),s=e.find((function(e){return e.address===(null===a||void 0===a?void 0:a.address)}));return a&&s?(0,f.parseUnits)(s.amount,18).toString():"0"}if("GqlPoolTokenComposableStable"===t.__typename){var i=t.pool,u=n.getDenormAmounts(e,t.pool.tokens),c=i.tokens.map((function(e){return(0,f.parseUnits)(e.balance,e.decimals)})),d=i.tokens.map((function(e){return e.decimals}));return(0,b.phantomStableBPTForTokensZeroPriceImpact)(c,d,u,(0,p.SW)(t.balance).toString(),(0,p.zb)((0,l.IW)(i.amp)).toString(),(0,p.SW)(i.swapFee).toString(),i.tokens.map((function(e){return(0,p.SW)(e.priceRate,18).toString()}))).toString()}return"0"}))},t.getProportionallyWeightedBptAmountsForTokensOut=function(e){var t=this,n=P(this.pool.tokens);return this.pool.withdrawConfig.options.map((function(r){var o=r.tokenOptions[0],a=t.pool.tokens.find((function(e){return e.index===r.poolTokenIndex})),s=(0,p.cz)((0,p.cz)(a.balance).times(a.priceRate)).div(n);if("GqlPoolToken"===a.__typename||"GqlPoolTokenLinear"===a.__typename)return{address:o.address,amount:(0,p.cz)(e).times(s).toFixed(18).toString()};var i=P(a.pool.tokens),u=A(o.address,a.pool.tokens),c=(0,p.cz)(u.balance).div(i);return{address:o.address,amount:(0,p.cz)(e).times(s).times(c).toFixed(18).toString()}}))},t.getWithdrawOptionAndPoolTokenForTokenOut=function(e){var t=this.pool.withdrawConfig.options.find((function(t){return t.tokenOptions.find((function(t){return t.address===e}))}));if(!t)throw new Error("No option found for token ".concat(e));var n=this.pool.tokens.find((function(e){return e.index===t.poolTokenIndex}));if(!n)throw new Error("No pool token found for token ".concat(e));return{option:t,poolToken:n,tokenOption:t.tokenOptions[0]}},e}(),B=n(96486),G=n(57290),_=function(){function e(t){(0,o.Z)(this,e),this.pool=t}var t=e.prototype;return t.updatePool=function(e){this.pool=e},t.getProportionalSuggestion=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=(0,B.sortBy)(t.pool.tokens.map((function(n){if("GqlPoolTokenComposableStable"===n.__typename){var r,o,a=n.pool.tokens.map((function(r){var o=t.getBptOutForToken(e,r,n.pool.totalShares);return(0,y.Z)((0,w.Z)({},o),{bptOutFloat:o&&parseFloat((0,p.i$)(o.bptOut))})})),s=(0,B.sortBy)(a,"bptOutFloat").filter(Boolean),i=(0,p.Qf)(s.map((function(e){var r;return t.calculateAmountIn(n.pool.totalShares,s[0].bptOut||(0,p.cz)(0),(null===(r=e.token)||void 0===r?void 0:r.balance)||"0").toString()}))).toFixed((null===(r=s[0].token)||void 0===r?void 0:r.decimals)||18);return{bptOut:parseFloat((0,p.i$)(t.calculateBptOut(t.pool.dynamicData.totalShares,i,n.balance))),token:{address:null===(o=s[0].token)||void 0===o?void 0:o.address,amount:i}}}var u=t.getBptOutForToken(e,n,t.pool.dynamicData.totalShares);return(0,y.Z)((0,w.Z)({},u),{bptOut:u&&parseFloat((0,p.i$)(u.bptOut))})})),"bptOut"),i={amount:(null===(r=a[0].token)||void 0===r?void 0:r.amount)||"0",address:(0,G.TS)((null===(o=a[0].token)||void 0===o?void 0:o.address)||"")},n.abrupt("return",i);case 4:case"end":return n.stop()}}),n)})))()},t.getBptOutForToken=function(e,t,n){var r,o="GqlPoolTokenLinear"===t.__typename?this.getInvestTokenForLinearPoolToken(e,t):e.find((function(e){return e.address===t.address||e.address===(0,G.DL)(t.address)}));if(!o)return null;var a="GqlPoolTokenLinear"===t.__typename?null===(r=t.pool.tokens.find((function(e){return e.address===o.address})))||void 0===r?void 0:r.decimals:t.decimals;return{bptOut:this.calculateBptOut(n,o.amount,t.balance,t.decimals,t.priceRate),token:(0,y.Z)((0,w.Z)({},o),{decimals:a,balance:t.balance})}},t.calculateBptOut=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:18,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"1.0",a=(0,p.kx)(n,r).times(o),s=(0,p.kx)(t,r).div(a);return(0,p.kx)(e,18).times(s)},t.calculateAmountIn=function(e,t,n){var r=t.div((0,p.kx)(e,18)),o=(0,p.kx)(n,18).times(r);return(0,p.i$)(o)},t.getInvestTokenForLinearPoolToken=function(e,t){return e.find((function(e){if("GqlPoolTokenLinear"===t.__typename)return!!t.pool.tokens.find((function(t){return t.address===e.address}))}))},e}(),C=function(){function e(t,n,r){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.wethAddress=r,this.baseService=new x(t,r),this.proportionalInvestService=new _(t)}var t=e.prototype;return t.updatePool=function(e){this.pool=e,this.baseService.updatePool(e),this.proportionalInvestService.updatePool(e)},t.joinGetProportionalSuggestionForFixedAmount=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.Uz)(e,n.pool.tokens));case 1:case"end":return t.stop()}}),t)})))()},t.joinGetMaxProportionalForUserBalances=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.proportionalInvestService.getProportionalSuggestion(e);case 2:return r=n.sent,n.next=5,t.joinGetProportionalSuggestionForFixedAmount(r,e.map((function(e){return(0,G.TS)(e.address)})));case 5:return o=n.sent,n.abrupt("return",o);case 7:case"end":return n.stop()}}),n)})))()},t.joinGetBptOutAndPriceImpactForTokensIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(o=n.exactTokensInForBPTOut(e)).lt(0)){r.next=3;break}return r.abrupt("return",{priceImpact:0,minBptReceived:"0"});case 3:return a=n.bptForTokensZeroPriceImpact(e),i=o.minus(o.times(t)).toFixed(0),r.abrupt("return",{priceImpact:o.div(a).minus(1).toNumber(),minBptReceived:(0,m.S5)(i.toString(),18)});case 6:case"end":return r.stop()}}),r)})))()},t.joinGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.pool.tokens.map((function(n){return e.wethIsEth?t.baseService.wethToZero(n.address):n.address})),i=(0,l.Xp)(e.maxAmountsIn,t.pool.tokens),u=t.encodeJoinPool(e),!("MASTER_CHEF"===(null===(r=t.pool.staking)||void 0===r?void 0:r.type)&&e.zapIntoMasterchefFarm||"GAUGE"===(null===(o=t.pool.staking)||void 0===o?void 0:o.type)&&e.zapIntoGauge)){n.next=6;break}return n.abrupt("return",t.batchRelayerService.encodeJoinPoolAndStake({userData:u,pool:t.pool,assets:a,maxAmountsIn:i,userAddress:e.userAddress}));case 6:return n.abrupt("return",{type:"JoinPool",assets:a,maxAmountsIn:i,userData:u});case 7:case"end":return n.stop()}}),n)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.OY)(e,n.pool.tokens,n.pool.dynamicData.totalShares));case 1:case"end":return t.stop()}}),t)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u,c;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=(0,p.zb)((0,f.parseUnits)(e)),a=(0,l.GF)(t,n.pool.tokens),i=n.exactBPTInForTokenOut(e,t),u=(0,m.S5)(i.toString(),a.decimals),c=n.bptForTokensZeroPriceImpact([{address:t,amount:u}]),r.abrupt("return",{tokenAmount:u,priceImpact:o.div(c).minus(1).toNumber()});case 6:case"end":return r.stop()}}),r)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.bptInForExactTokenOut(e),o=t.bptForTokensZeroPriceImpact([e]),n.abrupt("return",{bptIn:(0,m.S5)(r.toString(),18),priceImpact:r.div(o).minus(1).toNumber()});case 3:case"end":return n.stop()}}),n)})))()},t.exitGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=e.kind,n.next="ExactBPTInForOneTokenOut"===n.t0?3:"ExactBPTInForTokensOut"===n.t0?6:8;break;case 3:return r=t.pool.tokens.find((function(t){return t.address===e.tokenOutAddress})),o=(0,p.yV)(e.amountOut,(null===r||void 0===r?void 0:r.decimals)||18,e.slippage),n.abrupt("return",{type:"ExitPool",assets:t.pool.tokens.map((function(e){return e.address})),minAmountsOut:(0,l.Xp)([{address:e.tokenOutAddress,amount:o}],t.pool.tokens),userData:t.encodeExitPool(e)});case 6:return a=e.amountsOut.map((function(n){var r=t.pool.tokens.find((function(e){return e.address===n.address}));return{address:n.address,amount:(0,p.yV)(n.amount,(null===r||void 0===r?void 0:r.decimals)||18,e.slippage)}})),n.abrupt("return",{type:"ExitPool",assets:t.pool.tokens.map((function(e){return e.address})),minAmountsOut:(0,l.Xp)(a,t.pool.tokens),userData:t.encodeExitPool(e)});case 8:throw new Error("unsupported exit");case 9:case"end":return n.stop()}}),n)})))()},t.bptForTokensZeroPriceImpact=function(e){var t=(0,l.g3)(e,this.pool.tokens),n=(0,d.weightedBPTForTokensZeroPriceImpact)(this.baseService.tokenBalancesScaled.map((function(e){return(0,p.tz)(e)})),this.pool.tokens.map((function(e){return e.decimals})),this.baseService.tokenWeightsScaled.map((function(e){return(0,p.tz)(e)})),t.map((function(e){return(0,p.tz)(e)})),(0,f.parseUnits)(this.pool.dynamicData.totalShares));return(0,p.zb)(n)},t.exactTokensInForBPTOut=function(e){return i.v5._calcBptOutGivenExactTokensIn(this.baseService.tokenBalancesScaled,this.baseService.tokenWeightsScaled,(0,l.g3)(e,this.pool.tokens),this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)},t.bptInForExactTokensOut=function(e){return i.v5._calcBptInGivenExactTokensOut(this.baseService.tokenBalancesScaled,this.baseService.tokenWeightsScaled,(0,l.g3)(e,this.pool.tokens),this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)},t.bptInForExactTokenOut=function(e){var t=(0,l.GF)(e.address,this.pool.tokens),n=(0,p.SW)(t.balance,t.decimals),r=(0,p.cz)(t.weight?(0,f.parseUnits)(t.weight).toString():"0"),o=(0,p.SW)(e.amount,t.decimals);return i.v5._calcBptInGivenExactTokenOut(n,r,o,this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)},t.exactBPTInForTokenOut=function(e,t){var n=(0,l.GF)(t,this.pool.tokens),r=(0,p.SW)(n.balance,n.decimals),o=(0,p.cz)(n.weight?(0,f.parseUnits)(n.weight).toString():"0"),a=(0,p.SW)(e);return i.v5._calcTokenOutGivenExactBptIn(r,o,a,this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)},t.encodeJoinPool=function(e){if("Init"==e.kind)return h.WeightedPoolEncoder.joinInit((0,l.Xp)(e.tokenAmountsIn,this.pool.tokens));if("ExactTokensInForBPTOut"==e.kind)return h.WeightedPoolEncoder.joinExactTokensInForBPTOut((0,l.Xp)(e.tokenAmountsIn,this.pool.tokens),(0,f.parseUnits)(e.minimumBpt));if("AllTokensInForExactBPTOut"==e.kind)return h.WeightedPoolEncoder.joinAllTokensInForExactBPTOut((0,f.parseUnits)(e.bptAmountOut));if("TokenInForExactBPTOut"===e.kind){var t=(0,l.GF)(e.tokenInAddress,this.pool.tokens);return h.WeightedPoolEncoder.joinTokenInForExactBPTOut((0,f.parseUnits)(e.bptAmountOut),t.index)}throw new Error("unsupported join type")},t.encodeExitPool=function(e){if("ExactBPTInForOneTokenOut"==e.kind){var t=(0,l.GF)(e.tokenOutAddress,this.pool.tokens);return h.WeightedPoolEncoder.exitExactBPTInForOneTokenOut((0,f.parseUnits)(e.bptAmountIn),t.index)}if("ExactBPTInForTokensOut"==e.kind)return h.WeightedPoolEncoder.exitExactBPTInForTokensOut((0,f.parseUnits)(e.bptAmountIn));if("BPTInForExactTokensOut"===e.kind)return h.WeightedPoolEncoder.exitBPTInForExactTokensOut((0,l.Xp)(e.amountsOut,this.pool.tokens),(0,f.parseUnits)(e.maxBPTAmountIn));throw new Error("Unsupported exit type")},e}(),Z=n(21046),R=function(){function e(t,n,r,a){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.wethAddress=r,this.provider=a,this.baseService=new x(t,r),this.weightedPoolService=new C(t,n,r),this.proportionalInvestService=new _(t)}var t=e.prototype;return t.updatePool=function(e){this.pool=e,this.baseService.updatePool(e),this.weightedPoolService.updatePool(e),this.proportionalInvestService.updatePool(e)},t.joinGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,p,l,d;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("ExactTokensInForBPTOut"===e.kind){n.next=2;break}throw new Error("unsupported join type");case 2:return r=[],n.next=5,t.getJoinSwaps(e.tokenAmountsIn);case 5:return o=n.sent,a=o.swaps,i=o.assets,u=o.deltas,c=o.tokensIn,p=o.tokensOut,l=e.wethIsEth?e.tokenAmountsIn.find((function(e){return e.address===t.wethAddress})):void 0,d=(l?(0,f.parseUnits)(l.amount,18):Z._Y).toString(),r.push(t.encodeBatchSwapStep({tokensIn:c,tokensOut:p,deltas:u,data:e,ethAmountScaled:d,assets:i,swaps:a,fromInternalBalance:!1,toInternalBalance:!0,wethIsEth:e.wethIsEth})),r.push(t.encodeJoinPool({deltas:u,data:e,ethAmountScaled:d,batchSwapAssets:i,fromInternalBalance:!0})),e.zapIntoMasterchefFarm&&r.push(t.batchRelayerService.masterChefEncodeDeposit({sender:t.batchRelayerService.batchRelayerAddress,recipient:e.userAddress,token:t.pool.address,pid:parseInt(t.pool.staking.id),amount:t.batchRelayerService.toChainedReference(0),outputReference:Z._Y})),n.abrupt("return",{type:"BatchRelayer",calls:r,ethValue:l?d:void 0});case 17:case"end":return n.stop()}}),n)})))()},t.joinGetMaxProportionalForUserBalances=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.proportionalInvestService.getProportionalSuggestion(e);case 2:return r=n.sent,n.next=5,t.joinGetProportionalSuggestionForFixedAmount(r,e.map((function(e){return(0,G.TS)(e.address)})));case 5:return o=n.sent,n.abrupt("return",o);case 7:case"end":return n.stop()}}),n)})))()},t.joinGetProportionalSuggestionForFixedAmount=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getJoinSwaps([e]);case 2:if(1===(o=r.sent.tokenAmountsMappedToPoolTokens).length){r.next=5;break}throw new Error("PoolWeightedBoostedService: Incorrect token amounts returned by getJoinSwaps");case 5:return r.next=7,n.weightedPoolService.joinGetProportionalSuggestionForFixedAmount(o[0],o.map((function(e){return e.address})));case 7:return a=r.sent,i=a.map((function(e){var r=n.pool.investConfig.options.find((function(t){return t.poolTokenAddress===e.address})).tokenOptions.find((function(e){return t.includes(e.address)}));return(0,y.Z)((0,w.Z)({},e),{tokenOut:r.address})})),r.next=11,n.getExitSwaps(i);case 11:return u=r.sent.tokenOutAmounts,r.abrupt("return",u);case 13:case"end":return r.stop()}}),r)})))()},t.joinGetBptOutAndPriceImpactForTokensIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getJoinSwaps(e);case 2:if(o=r.sent.tokenAmountsMappedToPoolTokens,!(a=n.weightedPoolService.exactTokensInForBPTOut(o)).lt(0)){r.next=6;break}return r.abrupt("return",{priceImpact:0,minBptReceived:"0"});case 6:return i=n.weightedPoolService.bptForTokensZeroPriceImpact(o),u=a.minus(a.times(t)).toFixed(0),r.abrupt("return",{priceImpact:a.div(i).minus(1).toNumber(),minBptReceived:(0,m.S5)(u.toString(),18)});case 9:case"end":return r.stop()}}),r)})))()},t.exitGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,l,f,m,h,v,k,x,S,b;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r="ExactBPTInForOneTokenOut"===e.kind?[e.tokenOutAddress]:e.amountsOut.map((function(e){return e.address})),a=[],"ExactBPTInForTokensOut"!==e.kind){n.next=13;break}return n.next=6,t.weightedPoolService.exitGetProportionalWithdrawEstimate(e.bptAmountIn,t.pool.tokens.map((function(e){return e.address})));case 6:return i=n.sent,a=i,n.next=10,t.weightedPoolService.exitGetContractCallData((0,y.Z)((0,w.Z)({},e),{amountsOut:i}));case 10:case 21:o=n.sent,n.next=25;break;case 13:if("ExactBPTInForOneTokenOut"!==e.kind){n.next=24;break}return u=O(e.tokenOutAddress,t.pool.tokens,t.pool.withdrawConfig.options),n.next=17,t.weightedPoolService.exitGetSingleAssetWithdrawForBptIn(e.bptAmountIn,u.address);case 17:return c=n.sent,a=[{address:u.address,amount:c.tokenAmount}],n.next=21,t.weightedPoolService.exitGetContractCallData((0,y.Z)((0,w.Z)({},e),{tokenOutAddress:u.address,amountOut:c.tokenAmount}));case 24:throw new Error("Unsupported exit type: "+e.kind);case 25:return l=o.assets.map((function(e,n){return{asset:e,index:n,key:t.batchRelayerService.toChainedReference(n)}})),f=t.batchRelayerService.vaultConstructExitCall({poolId:t.pool.id,poolKind:0,assets:o.assets,minAmountsOut:o.minAmountsOut.map((function(e){return e.toString()})),userData:o.userData,sender:e.userAddress,recipient:e.userAddress,outputReferences:l,toInternalBalance:t.hasOnlyPhantomBpts}),m=t.phantomBptPoolTokens.filter((function(e){return a.find((function(t){return t.address===e.address}))})),h=m.map((function(e){var n=a.find((function(t){return t.address===e.address})),o=t.pool.withdrawConfig.options.find((function(t){return t.poolTokenIndex===e.index})).tokenOptions.find((function(e){return r.includes(e.address)}));return{address:e.address,amount:n.amount,tokenOut:o.address}})),n.next=31,t.getExitSwaps(h);case 31:return v=n.sent,k=v.swaps,x=v.deltas,S=v.assets,k.forEach((function(e){var t=S[e.assetInIndex],n=l.findIndex((function(e){return(0,d.isSameAddress)(e.asset,t)}));-1!==n&&(e.amount=l[n].key.toString())})),S.forEach((function(t,n){r.includes(t)&&(x[n]=(0,p.cz)(x[n]).times(1-parseFloat(e.slippage)).toFixed(0))})),b=t.batchRelayerService.vaultEncodeBatchSwap({swapType:d.SwapType.SwapExactIn,swaps:k,assets:S,funds:{sender:e.userAddress,recipient:e.userAddress,fromInternalBalance:t.hasOnlyPhantomBpts,toInternalBalance:!1},limits:x,deadline:Z.Bz,value:Z._Y,outputReferences:[]}),n.abrupt("return",{type:"BatchRelayer",calls:[f,b]});case 39:case"end":return n.stop()}}),n)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=O(e.address,t.pool.tokens,t.pool.withdrawConfig.options),e.address!==r.address){n.next=3;break}return n.abrupt("return",t.weightedPoolService.exitGetBptInForSingleAssetWithdraw(e));case 3:return n.next=5,t.getJoinSwaps([e]);case 5:return o=n.sent.tokenAmountsMappedToPoolTokens,n.abrupt("return",t.weightedPoolService.exitGetBptInForSingleAssetWithdraw(o[0]));case 7:case"end":return n.stop()}}),n)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=O(t,n.pool.tokens,n.pool.withdrawConfig.options),r.next=3,n.weightedPoolService.exitGetSingleAssetWithdrawForBptIn(e,o.address);case 3:if(a=r.sent,o.address!==t){r.next=6;break}return r.abrupt("return",a);case 6:return r.next=8,n.getExitSwaps([{address:o.address,amount:a.tokenAmount,tokenOut:t}]);case 8:return i=r.sent.tokenOutAmounts,r.abrupt("return",{priceImpact:a.priceImpact,tokenAmount:i[0].amount});case 10:case"end":return r.stop()}}),r)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.weightedPoolService.exitGetProportionalWithdrawEstimate(e,n.pool.tokens.map((function(e){return e.address})));case 2:return o=r.sent,a=o.filter((function(e){return e.address})).map((function(e){var r=e.amount,o=e.address,a=n.pool.withdrawConfig.options.find((function(e){return e.poolTokenAddress===o})).tokenOptions.find((function(e){return t.includes(e.address)}));return{address:o,amount:r,tokenOut:a.address}})),r.next=6,n.getExitSwaps(a);case 6:return i=r.sent.tokenOutAmounts,r.abrupt("return",i);case 8:case"end":return r.stop()}}),r)})))()},t.getJoinSwaps=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,d,f,h,v,k,x,S,w,y,T,I,P;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(r=[],o=!0,a=!1,i=void 0,n.prev=2,u=e[Symbol.iterator]();!(o=(c=u.next()).done);o=!0)d=c.value,"GqlPoolTokenLinear"!==(f=O(d.address,t.pool.tokens,t.pool.investConfig.options)).__typename&&"GqlPoolTokenComposableStable"!==f.__typename||(h=g({poolId:t.pool.id,poolAddress:t.pool.address,tokenAmountIn:d,poolToken:f}),v=h.swaps,k=h.assets,r.push({swaps:v.slice(0,v.length-1),assets:k.slice(0,k.length-1)}));n.next=10;break;case 6:n.prev=6,n.t0=n.catch(2),a=!0,i=n.t0;case 10:n.prev=10,n.prev=11,o||null==u.return||u.return();case 13:if(n.prev=13,!a){n.next=16;break}throw i;case 16:return n.finish(13);case 17:return n.finish(10);case 18:return x=(0,l.Nu)(r.map((function(e){return e.assets})),r.map((function(e){return e.swaps}))),S=x.swaps,w=x.assets,n.next=21,(0,l.GR)({swapType:b.SwapTypes.SwapExactIn,swaps:S,assets:w,provider:t.provider});case 21:return y=n.sent,T=e.map((function(e){return e.address})),I=[],P=e.map((function(e){var n=O(e.address,t.pool.tokens,t.pool.investConfig.options);if("GqlPoolTokenComposableStable"===n.__typename||"GqlPoolTokenLinear"===n.__typename){var r=w.findIndex((function(e){return e===n.address})),o=y[r];return I.push(n.address),{address:n.address,amount:(0,m.S5)((0,p.cz)(o).abs().toString(),18)}}return e})),n.abrupt("return",{swaps:S,assets:w,deltas:y,tokenAmountsMappedToPoolTokens:P,tokensOut:I,tokensIn:T});case 26:case"end":return n.stop()}}),n,null,[[2,6,10,18],[11,,13,17]])})))()},t.encodeBatchSwapStep=function(e){var t=e.tokensIn,n=e.tokensOut,r=e.deltas,o=e.assets,a=e.data,s=e.swaps,i=e.ethAmountScaled,u=e.fromInternalBalance,c=e.toInternalBalance,l=e.wethIsEth,f=this,m=d.Swaps.getLimitsForSlippage(t,n,d.SwapType.SwapExactIn,r,o,"".concat((0,p.kx)(a.slippage,16).toFixed(0)));return this.batchRelayerService.vaultEncodeBatchSwap({swapType:d.SwapType.SwapExactIn,swaps:s,assets:l?o.map((function(e){return f.baseService.wethToZero(e)})):o,funds:{sender:a.userAddress,recipient:a.userAddress,fromInternalBalance:u,toInternalBalance:c},limits:m.map((function(e){return e.toString()})),deadline:Z.Bz,value:i,outputReferences:o.map((function(e,t){return{index:t,key:f.batchRelayerService.toChainedReference(t)}}))})},t.encodeJoinPool=function(e){var t=e.deltas,n=e.batchSwapAssets,r=e.data,o=e.ethAmountScaled,a=e.fromInternalBalance,s=this,i=r.wethIsEth&&this.pool.tokens.find((function(e){return e.address===s.wethAddress})),u=this.pool.tokens.map((function(e){var o=r.tokenAmountsIn.find((function(t){return t.address===e.address}));if(o)return(0,f.parseUnits)(o.amount,e.decimals).toString();var a=n.findIndex((function(t){return t.toLowerCase()===e.address}))||-1;return-1===a||"0"===t[a]?"0":s.batchRelayerService.toChainedReference(a)}));return this.batchRelayerService.vaultEncodeJoinPool({poolId:this.pool.id,poolKind:0,sender:r.userAddress,recipient:r.zapIntoMasterchefFarm?this.batchRelayerService.batchRelayerAddress:r.userAddress,joinPoolRequest:{assets:this.pool.tokens.map((function(e){return r.wethIsEth?s.baseService.wethToZero(e.address):e.address})),maxAmountsIn:u,userData:d.WeightedPoolEncoder.joinExactTokensInForBPTOut(u,(0,f.parseUnits)(r.minimumBpt,18)),fromInternalBalance:a},value:i?o:Z._Y,outputReference:r.zapIntoMasterchefFarm?this.batchRelayerService.toChainedReference(0):Z._Y})},t.getExitSwaps=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,d,f,h,v,k,x;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(r=[],o=!0,a=!1,i=void 0,n.prev=2,u=function(e,n){var o=n.value,a=t.pool.tokens.find((function(e){return e.address===o.address}));if(!a)throw new Error("Exit token is not a pool token: ".concat(o.amount));"GqlPoolTokenLinear"!==a.__typename&&"GqlPoolTokenComposableStable"!==a.__typename||r.push(t.phantomBptPoolTokenGetExitSwaps({tokenOut:o.tokenOut,bptIn:o.amount,poolToken:a}))},c=e[Symbol.iterator]();!(o=(d=c.next()).done);o=!0)u(0,d);n.next=11;break;case 7:n.prev=7,n.t0=n.catch(2),a=!0,i=n.t0;case 11:n.prev=11,n.prev=12,o||null==c.return||c.return();case 14:if(n.prev=14,!a){n.next=17;break}throw i;case 17:return n.finish(14);case 18:return n.finish(11);case 19:return f=(0,l.Nu)(r.map((function(e){return e.assets})),r.map((function(e){return e.swaps}))),h=f.swaps,v=f.assets,n.next=22,(0,l.GR)({swapType:b.SwapTypes.SwapExactIn,swaps:h,assets:v,provider:t.provider});case 22:return k=n.sent,x=e.map((function(e){var n=e.address,r=e.tokenOut,o=e.amount;if(n===r)return{address:r,amount:o};var a=v.findIndex((function(e){return e.toLowerCase()===r})),s=t.pool.allTokens.find((function(e){return e.address===r}));if(-1===a)throw new Error("getExitSwaps: Nested BPT missing in assets array ".concat(r));return{address:r,amount:(0,m.S5)((0,p.cz)(k[a]).abs().toString(),s.decimals)}})),n.abrupt("return",{swaps:h,assets:v,deltas:k,tokenOutAmounts:x});case 25:case"end":return n.stop()}}),n,null,[[2,7,11,19],[12,,14,18]])})))()},t.phantomBptPoolTokenGetExitSwaps=function(e){var t=e.bptIn,n=e.poolToken,r=e.tokenOut,o=(0,f.parseUnits)(t,18).toString();if("GqlPoolTokenLinear"===n.__typename){var a=n.pool.tokens.find((function(e){return e.address===r}));if(!a)throw new Error("Token does not exist in pool token: ".concat(r));return{swaps:[{poolId:n.pool.id,assetInIndex:0,assetOutIndex:1,amount:o,userData:"0x"}],assets:[n.address,a.address]}}if("GqlPoolTokenComposableStable"===n.__typename){var s=A(r,n.pool.tokens);if(!s)throw new Error("Token does not exist in pool token: ".concat(r));var i=this.phantomBptPoolTokenGetExitSwaps({bptIn:"0",poolToken:s,tokenOut:r}),u=i.swaps,c=i.assets;return{swaps:[{poolId:n.pool.id,assetInIndex:0,assetOutIndex:1,amount:o,userData:"0x"}].concat((0,T.Z)(u.map((function(e){return(0,y.Z)((0,w.Z)({},e),{assetInIndex:e.assetInIndex+1,assetOutIndex:e.assetOutIndex+1})})))),assets:[n.address].concat((0,T.Z)(c))}}throw new Error("No available join swap path for poolId: ".concat(n.address," and token: ").concat(r))},(0,v.Z)(e,[{key:"hasOnlyPhantomBpts",get:function(){return"HAS_ONLY_PHANTOM_BPT"===this.pool.nestingType}},{key:"phantomBptPoolTokens",get:function(){return this.pool.tokens.filter(V)}}]),e}(),W=n(23043),D=n(29907),j=n(93178),q=function(){function e(t,n,r){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.wethAddress=r,this.baseService=new x(t,r)}var t=e.prototype;return t.updatePool=function(e){this.baseService.updatePool(e),this.pool=e},t.joinGetProportionalSuggestionForFixedAmount=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.Uz)(e,n.pool.tokens));case 1:case"end":return t.stop()}}),t)})))()},t.joinGetBptOutAndPriceImpactForTokensIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){var r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=n.exactTokensInForBPTOut(e)).lt(0)){t.next=3;break}return t.abrupt("return",{priceImpact:0,minBptReceived:"0"});case 3:return o=n.bptForTokensZeroPriceImpact(e),t.abrupt("return",{priceImpact:o.lt(r)?0:(0,p.cz)(1).minus(r.div(o)).toNumber(),minBptReceived:(0,m.S5)(r.toString(),18)});case 5:case"end":return t.stop()}}),t)})))()},t.joinGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.pool.tokens.map((function(n){return e.wethIsEth?t.baseService.wethToZero(n.address):n.address})),i=(0,l.Xp)(e.maxAmountsIn,t.pool.tokens),u=t.encodeJoinPool(e),!("MASTER_CHEF"===(null===(r=t.pool.staking)||void 0===r?void 0:r.type)&&e.zapIntoMasterchefFarm||"GAUGE"===(null===(o=t.pool.staking)||void 0===o?void 0:o.type)&&e.zapIntoGauge)){n.next=6;break}return n.abrupt("return",t.batchRelayerService.encodeJoinPoolAndStake({userData:u,pool:t.pool,assets:a,maxAmountsIn:i,userAddress:e.userAddress}));case 6:return n.abrupt("return",{type:"JoinPool",assets:a,maxAmountsIn:i,userData:u});case 7:case"end":return n.stop()}}),n)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.OY)(e,n.pool.tokens,n.pool.dynamicData.totalShares,!0));case 1:case"end":return t.stop()}}),t)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.bptInForExactTokenOut(e),o=t.bptForTokensZeroPriceImpact([e]),n.abrupt("return",{bptIn:(0,m.S5)(r.toString(),18),priceImpact:r.div(o).minus(1).toNumber()});case 3:case"end":return n.stop()}}),n)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u,c;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=(0,p.zb)((0,f.parseUnits)(e)),a=(0,l.GF)(t,n.pool.tokens),i=n.exactBPTInForTokenOut(e,t),u=(0,m.S5)(i.toString(),a.decimals),c=n.bptForTokensZeroPriceImpact([{address:t,amount:u}]),r.abrupt("return",{tokenAmount:u,priceImpact:o.div(c).minus(1).toNumber()});case 6:case"end":return r.stop()}}),r)})))()},t.exitGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=e.kind,n.next="ExactBPTInForOneTokenOut"===n.t0?3:"ExactBPTInForTokensOut"===n.t0?6:8;break;case 3:return r=t.pool.tokens.find((function(t){return t.address===e.tokenOutAddress})),o=(0,p.yV)(e.amountOut,(null===r||void 0===r?void 0:r.decimals)||18,e.slippage),n.abrupt("return",{type:"ExitPool",assets:t.pool.tokens.map((function(e){return e.address})),minAmountsOut:(0,l.Xp)([{address:e.tokenOutAddress,amount:o}],t.pool.tokens),userData:t.encodeExitPool(e)});case 6:return a=e.amountsOut.map((function(n){var r=t.pool.tokens.find((function(e){return e.address===n.address}));return{address:n.address,amount:(0,p.yV)(n.amount,(null===r||void 0===r?void 0:r.decimals)||18,e.slippage)}})),n.abrupt("return",{type:"ExitPool",assets:t.pool.tokens.map((function(e){return e.address})),minAmountsOut:(0,l.Xp)(a,t.pool.tokens),userData:t.encodeExitPool(e)});case 8:throw new Error("unsupported exit");case 9:case"end":return n.stop()}}),n)})))()},t.bptForTokensZeroPriceImpact=function(e){var t=this,n=(0,l.Xp)(e,this.pool.tokens),r=this.pool.tokens.map((function(e,n){return(0,f.parseUnits)(e.balance,e.decimals).mul(t.baseService.priceRatesScaled[n].toString()).div(Z.Ce)})),o=(0,d.stableBPTForTokensZeroPriceImpact)(r,this.pool.tokens.map((function(e){return e.decimals})),n,this.baseService.totalSharesScaled.toString(),this.baseService.ampScaled.toString());return(0,p.zb)(o)},t.exactTokensInForBPTOut=function(e){try{return i._E._calcBptOutGivenExactTokensIn(this.baseService.ampScaled,this.baseService.tokenBalancesScaledTo18Decimals,this.baseService.scaleTokenAmountsTo18Decimals(e),this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)}catch(t){return console.error(t),(0,p.RV)()}},t.bptInForExactTokensOut=function(e){return i._E._calcBptInGivenExactTokensOut(this.baseService.ampScaled,this.baseService.tokenBalancesScaledTo18Decimals,this.baseService.scaleTokenAmountsTo18Decimals(e),this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)},t.bptInForExactTokenOut=function(e){return i._E._calcBptInGivenExactTokensOut(this.baseService.ampScaled,this.baseService.tokenBalancesScaledTo18Decimals,this.baseService.scaleTokenAmountsTo18Decimals([e]),this.baseService.totalSharesScaled,this.baseService.swapFeeScaled)},t.exactBPTInForTokenOut=function(e,t){if((0,p.cz)(e).eq(0))return(0,p.RV)();var n=(0,l.GF)(t,this.pool.tokens),r=(0,p.SW)(e),o=i._E._calcTokenOutGivenExactBptIn(this.baseService.ampScaled,this.baseService.tokenBalancesScaledTo18Decimals,n.index,r,this.baseService.totalSharesScaled,this.baseService.swapFeeScaled);return this.baseService.scaleTokenAmountDownFrom18Decimals(n,o,c().ROUND_DOWN)},t.encodeJoinPool=function(e){if("Init"==e.kind)return h.StablePoolEncoder.joinInit((0,l.Xp)(e.tokenAmountsIn,this.pool.tokens));if("ExactTokensInForBPTOut"==e.kind){var t=(0,p.yV)(e.minimumBpt,18,e.slippage);return h.StablePoolEncoder.joinExactTokensInForBPTOut((0,l.Xp)(e.tokenAmountsIn,this.pool.tokens),(0,f.parseUnits)(t,18))}if("TokenInForExactBPTOut"===e.kind){var n=(0,l.GF)(e.tokenInAddress,this.pool.tokens);return h.StablePoolEncoder.joinTokenInForExactBPTOut((0,f.parseUnits)(e.bptAmountOut),n.index)}throw new Error("unsupported join type")},t.encodeExitPool=function(e){if("ExactBPTInForOneTokenOut"==e.kind){var t=(0,l.GF)(e.tokenOutAddress,this.pool.tokens);return h.StablePoolEncoder.exitExactBPTInForOneTokenOut((0,f.parseUnits)(e.bptAmountIn),t.index)}if("ExactBPTInForTokensOut"==e.kind)return h.StablePoolEncoder.exitExactBPTInForTokensOut((0,f.parseUnits)(e.bptAmountIn));if("BPTInForExactTokensOut"===e.kind)return h.StablePoolEncoder.exitBPTInForExactTokensOut((0,l.Xp)(e.amountsOut,this.pool.tokens),(0,f.parseUnits)(e.maxBPTAmountIn));throw new Error("Unsupported exit type")},e}(),U=n(91747),L=function(){function e(t,n,r,a){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.provider=r,this.wethAddress=a}var t=e.prototype;return t.updatePool=function(e){this.pool=e},t.processJoinSteps=function(e){var t=e.tokenAmountsIn,n=(e.slippage,this);return(0,r.Z)(s().mark((function e(){var r,o,a,i,u,c,p,l,d,f,m,h,v;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],o=t.filter((function(e){return parseFloat(e.amount)>0})),a=!0,i=!1,u=void 0,e.prev=3,c=n.joinSteps[Symbol.iterator]();case 5:if(a=(p=c.next()).done){e.next=27;break}if(l=p.value,0!==(d=o.filter((function(e){return l.tokensIn.includes(e.address)}))).length){e.next=10;break}return e.abrupt("continue",24);case 10:if("Join"!==l.type){e.next=18;break}return e.next=13,n.joinStepGetJoinPool({joinStep:l,tokenAmountsIn:d});case 13:f=e.sent,o=(0,T.Z)(o.filter((function(e){return!l.tokensIn.includes(e.address)}))).concat([{address:l.pool.address,amount:f.minBptReceived}]),r.push(f),e.next=24;break;case 18:if("BatchSwap"!==l.type){e.next=24;break}return e.next=21,n.joinStepGetJoinBatchSwap({pool:n.pool,batchSwapStep:l,tokenAmountsIn:d,provider:n.provider});case 21:m=e.sent,o=(0,T.Z)(o.filter((function(e){return!l.tokensIn.includes(e.address)}))).concat((0,T.Z)(m.tokenAmountsOut)),r.push(m);case 24:a=!0,e.next=5;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(3),i=!0,u=e.t0;case 33:e.prev=33,e.prev=34,a||null==c.return||c.return();case 36:if(e.prev=36,!i){e.next=39;break}throw u;case 39:return e.finish(36);case 40:return e.finish(33);case 41:return h=r.filter((function(e){return"Join"===e.type})),v=h[h.length-1],e.abrupt("return",{processedSteps:r,priceImpact:v.priceImpact,minBptReceived:v.minBptReceived,nestedPriceImpacts:h.slice(0,h.length-1).map((function(e){return(0,y.Z)((0,w.Z)({},e),{poolId:e.pool.id})}))});case 44:case"end":return e.stop()}}),e,null,[[3,29,33,41],[34,,36,40]])})))()},t.joinGetContractCallData=function(e){var t=e.data,n=e.processedSteps,o=this;return(0,r.Z)(s().mark((function e(){var r,a,i,u,c,p,d,m,h,v,k,x;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],a=(0,l.ds)(t,o.wethAddress),a.ethAmount,i=a.ethAmountScaled,u=n.find((function(e){return"BatchSwap"===e.type})),c=n.filter((function(e){return"Join"===e.type})),u&&r.push(o.batchRelayerService.encodeBatchSwapWithLimits((0,y.Z)((0,w.Z)({},u),{tokensIn:u.tokenAmountsIn.map((function(e){return e.address})),tokensOut:u.tokenAmountsOut.map((function(e){return e.address})),sender:t.userAddress,recipient:t.userAddress,ethAmountScaled:i,slippage:"0.0001",fromInternalBalance:!1,toInternalBalance:!0,wethIsEth:t.wethIsEth}))),p=(null===u||void 0===u?void 0:u.assets)||[],d=(null===u||void 0===u?void 0:u.deltas)||[],m=p.length,h=0;h<c.length;h++)v=c[h],k=h<c.length-1,r.push(o.encodeJoinPool({step:v,batchSwapStep:u||null,ethAmountScaled:i,userAddress:t.userAddress,wethIsEth:t.wethIsEth,isNestedJoin:k,outputReference:m+h,assets:p,deltas:d,slippage:t.slippage})),p.push(v.pool.address),d.push((0,f.parseUnits)(v.minBptReceived,18).toString());return x=c.length>0?o.batchRelayerService.toChainedReference(0):o.batchRelayerService.toChainedReference(p.indexOf(o.pool.address)),t.zapIntoMasterchefFarm?r.push(o.batchRelayerService.masterChefEncodeDeposit({sender:t.userAddress,recipient:t.userAddress,token:o.pool.address,pid:parseInt(o.pool.staking.id),amount:x,outputReference:Z._Y})):t.zapIntoGauge&&r.push(o.batchRelayerService.gaugeEncodeDeposit({gauge:o.pool.staking.id,sender:t.userAddress,recipient:t.userAddress,amount:x})),e.abrupt("return",{type:"BatchRelayer",calls:r,ethValue:i});case 12:case"end":return e.stop()}}),e)})))()},t.joinStepGetJoinPool=function(e){var t=e.tokenAmountsIn,n=e.joinStep;return(0,r.Z)(s().mark((function e(){var r,o,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.pool,o="GqlPoolWeighted"===r.__typename?(0,l.Be)(t,r):(0,l.mA)(t,r),a="GqlPoolWeighted"===r.__typename?(0,l.Cd)(t,r):(0,l.Ds)(t,r),e.abrupt("return",{type:"Join",priceImpact:a.lt(o)?0:(0,p.cz)(1).minus(o.div(a)).toNumber(),minBptReceived:(0,m.S5)(o.toString(),18),tokenAmountsIn:t,pool:r});case 4:case"end":return e.stop()}}),e)})))()},t.joinStepGetJoinBatchSwap=function(e){var t=e.pool,n=e.tokenAmountsIn,o=e.batchSwapStep,a=e.provider;return(0,r.Z)(s().mark((function e(){var r,i,u,c,p,d,f,h,v,k,x,S;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],i=!0,u=!1,c=void 0,e.prev=2,p=function(e,n){var a=n.value,s=o.swaps.find((function(e){return e.tokenIn===a.address}));if(s){var i=t.allTokens.find((function(e){return e.address===a.address}));r.push({swap:{poolId:s.poolId,assetInIndex:0,assetOutIndex:1,amount:(0,m.Ox)(a.amount,(null===i||void 0===i?void 0:i.decimals)||18).toString(),userData:"0x"},assets:[s.tokenIn,s.tokenOut]})}},d=n[Symbol.iterator]();!(i=(f=d.next()).done);i=!0)p(0,f);e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),u=!0,c=e.t0;case 11:e.prev=11,e.prev=12,i||null==d.return||d.return();case 14:if(e.prev=14,!u){e.next=17;break}throw c;case 17:return e.finish(14);case 18:return e.finish(11);case 19:return h=(0,l.Nu)(r.map((function(e){return e.assets})),r.map((function(e){return[e.swap]}))),v=h.swaps,k=h.assets,e.next=22,(0,l.GR)({swapType:b.SwapTypes.SwapExactIn,swaps:v,assets:k,provider:a});case 22:return x=e.sent,S=o.swaps.map((function(e){var n=t.allTokens.find((function(t){return t.address===e.tokenOut})),r=k.findIndex((function(t){return t===e.tokenOut}));return{address:e.tokenOut,amount:(0,m.S5)(U.O$.from(x[r]||"0").abs(),(null===n||void 0===n?void 0:n.decimals)||18)}})).filter((function(e){return parseFloat(e.amount)>0})),e.abrupt("return",{type:"BatchSwap",swaps:v,assets:k,deltas:x,tokenAmountsIn:n,tokenAmountsOut:S});case 25:case"end":return e.stop()}}),e,null,[[2,7,11,19],[12,,14,18]])})))()},t.encodeJoinPool=function(e){var t=e.step,n=e.batchSwapStep,r=e.userAddress,o=e.wethIsEth,a=e.ethAmountScaled,s=e.isNestedJoin,i=e.outputReference,u=e.assets,c=e.deltas,l=e.slippage,m=this,h=t.pool,v=o&&h.tokens.find((function(e){return e.address===m.wethAddress})),x=h.tokens.filter((function(e){return e.address!==h.address})),S="GqlPoolWeighted"===h.__typename?(0,B.sortBy)(h.tokens,"index"):(0,B.sortBy)((0,T.Z)(x).concat([{address:h.address,decimals:18,__typename:"pool"}]),"address"),b=S.findIndex((function(e){return e.address===h.address})),w=S.map((function(e){if(e.address===h.address)return Z._Y.toString();var n=t.tokenAmountsIn.find((function(t){return t.address===e.address}));if("GqlPoolTokenLinear"===e.__typename||"GqlPoolTokenComposableStable"===e.__typename){var r=u.findIndex((function(t){return t.toLowerCase()===e.address}));return-1===r||"0"===c[r]?"0":m.batchRelayerService.toChainedReference(r)}return(0,f.parseUnits)((null===n||void 0===n?void 0:n.amount)||"0",e.decimals).toString()})),y=S.map((function(e){return e.address}));return this.batchRelayerService.vaultEncodeJoinPool({poolId:h.id,poolKind:0,sender:r,recipient:r,joinPoolRequest:{assets:v?y.map((function(e){return(0,d.isSameAddress)(e,m.wethAddress)?k.d:e})):y,maxAmountsIn:w,userData:d.StablePoolEncoder.joinExactTokensInForBPTOut(w.filter((function(e,t){return t!==b})),(0,f.parseUnits)((0,p.yV)(t.minBptReceived,18,l),18)),fromInternalBalance:null!==n},value:v?a:Z._Y,outputReference:s?this.batchRelayerService.toChainedReference(i):this.batchRelayerService.toChainedReference(0)})},(0,v.Z)(e,[{key:"joinSteps",get:function(){var e=[],t=(0,l.AO)(this.pool),n=(0,l.KF)(this.pool);t.length>0&&e.push({type:"BatchSwap",swaps:t.map((function(e){var t=(0,l.fK)(e);return{poolId:e.pool.id,tokenIn:t.address,tokenOut:e.address}})),tokensIn:t.map((function(e){return(0,l.fK)(e).address}))});var r=!0,o=!1,a=void 0;try{for(var s,i=n[Symbol.iterator]();!(r=(s=i.next()).done);r=!0){var u=s.value;e.push({type:"Join",pool:u.pool,tokensIn:u.pool.tokens.map((function(e){return e.address}))})}}catch(c){o=!0,a=c}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return e.push({type:"Join",pool:this.pool,tokensIn:this.pool.tokens.map((function(e){return e.address}))}),e}}]),e}();!function(e){e[e.WEIGHTED=0]="WEIGHTED",e[e.LEGACY_STABLE=1]="LEGACY_STABLE",e[e.COMPOSABLE_STABLE=2]="COMPOSABLE_STABLE",e[e.COMPOSABLE_STABLE_V2=3]="COMPOSABLE_STABLE_V2"}(E||(E={}));var z=n(84243),N=function(){function e(t,n,r,a){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.provider=r,this.wethAddress=a,this.singleAssetExits=[];var s=!0,i=!1,u=void 0;try{for(var c,p=this.pool.withdrawConfig.options[Symbol.iterator]();!(s=(c=p.next()).done);s=!0){var l=c.value,d=!0,f=!1,m=void 0;try{for(var h,v=l.tokenOptions[Symbol.iterator]();!(d=(h=v.next()).done);d=!0){var k=h.value;this.singleAssetExits.push(this.buildSingleAssetExit({option:l,tokenOption:k}))}}catch(x){f=!0,m=x}finally{try{d||null==v.return||v.return()}finally{if(f)throw m}}}}catch(x){i=!0,u=x}finally{try{s||null==p.return||p.return()}finally{if(i)throw u}}}var t=e.prototype;return t.updatePool=function(e){this.pool=e},t.exitGetProportionalPoolTokenWithdrawEstimate=function(e){var t=this;return(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,l.OY)(e,t.pool.tokens,(0,l.kl)(t.pool),t.isStablePool));case 1:case"end":return n.stop()}}),n)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=(0,l.OY)(e,n.pool.tokens,(0,l.kl)(n.pool),n.isStablePool),r.abrupt("return",(0,l.fI)({pool:n.pool,nestedTokens:t,poolTokenAmounts:o}));case 2:case"end":return r.stop()}}),r)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u,c,p,l;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=n.getSingleAssetExitForTokenOut(t),a=e,i="0",u=n.getAmountOutForBptIn({bptIn:e,pool:n.pool,poolToken:o.poolToken}),c=u.tokenAmountOut,p=u.priceImpact,n.isWeightedPool&&(a=c,i=c),!o.exitSwaps){r.next=10;break}return r.next=8,n.getSingleAssetExitSwaps({exit:o,tokenOutAddress:t,amountIn:a});case 8:l=r.sent.mainTokenAmountOut,i=l;case 10:return r.abrupt("return",{priceImpact:p,tokenAmount:i,nestedPriceImpacts:[]});case 11:case"end":return r.stop()}}),r)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,h,v,k,x,S;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.getSingleAssetExitForTokenOut(e.address),o=r.poolToken,a=r.tokenOut,i="0",!r.exitSwaps){n.next=13;break}return u=r.linearPool&&parseFloat(e.amount)>parseFloat(r.linearPool.mainToken.totalBalance),c=(0,B.reverse)((0,B.cloneDeep)(r.exitSwaps.swaps)),h=(0,B.cloneDeep)(r.exitSwaps.assets),u&&r.linearPool?(v=r.linearPool.wrappedToken,k=(0,m.S5)((0,p.SW)(e.amount,a.decimals).div(v.priceRate).toFixed(0),a.decimals),h[h.length-1]=v.address,c[0].amount=(0,f.parseUnits)(k,v.decimals).toString()):c[0].amount=(0,f.parseUnits)(e.amount,a.decimals).toString(),n.next=11,(0,l.GR)({provider:t.provider,swaps:c,assets:h,swapType:d.SwapTypes.SwapExactOut});case 11:x=n.sent,i=(0,m.S5)(U.O$.from(x[0]||"0").abs(),18);case 13:return"GqlPoolWeighted"===t.pool.__typename&&(i=o.address===e.address?(0,l.$H)(t.pool,{address:o.address,amount:e.amount}):(0,l.$H)(t.pool,{address:o.address,amount:i})),S=t.getAmountOutForBptIn({bptIn:i,pool:t.pool,poolToken:r.poolToken}).priceImpact,n.abrupt("return",{bptIn:i,priceImpact:S});case 16:case"end":return n.stop()}}),n)})))()},t.exitExactBPTInForOneTokenOutGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,l,m,h,v,k,x,S,b,w,y,T,g,I,P,A,O,E,F;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.bptAmountIn,o=e.tokenOutAddress,a=e.amountOut,i=e.userAddress,u=e.slippage,c=t.getSingleAssetExitForTokenOut(o),l=c.poolToken,m=[],h=r,t.isWeightedPool&&(v=t.getAmountOutForBptIn({bptIn:r,pool:t.pool,poolToken:l}).tokenAmountOut,k=(0,f.parseUnits)((0,p.yV)(c.exitSwaps?v:a,l.decimals,u),l.decimals).toString(),x=t.batchRelayerService.vaultConstructExitCall({poolId:t.pool.id,poolKind:0,assets:t.pool.tokens.map((function(e){return e.address})),minAmountsOut:t.pool.tokens.map((function(e){return e.address===l.address?k:"0"})),userData:d.WeightedPoolEncoder.exitExactBPTInForOneTokenOut((0,f.parseUnits)(r,18),l.index),sender:i,recipient:i,outputReferences:t.pool.tokens.map((function(e){return{index:e.index,key:t.batchRelayerService.toChainedReference(e.index)}})),toInternalBalance:!!c.exitSwaps}),m.push(x),h=v),!c.exitSwaps){n.next=22;break}return null===(S=c.linearPool)||void 0===S?void 0:S.wrappedToken,b=c.exitSwaps.assets.indexOf(o),n.next=12,t.getSingleAssetExitSwaps({exit:c,tokenOutAddress:o,amountIn:h});case 12:w=n.sent,y=w.deltas,T=w.requiresUnwrap,g=w.swaps,I=w.assets,w.tokenAmountOut,T||(y[b]="-".concat((0,f.parseUnits)(a,c.tokenOut.decimals).toString())),t.isWeightedPool&&(g[0].amount=t.batchRelayerService.toChainedReference(l.index).toString(),P=(0,p.cz)(y[0]),y[0]=P.plus(P.times(u)).toFixed(0)),m.push(t.batchRelayerService.encodeBatchSwapWithLimits({tokensIn:[I[0]],tokensOut:[I[b]],swaps:g,assets:I,deltas:y,ethAmountScaled:"0",slippage:u,fromInternalBalance:t.isWeightedPool,toInternalBalance:!1,sender:i,recipient:T&&c.linearPool?t.batchRelayerService.batchRelayerAddress:i,skipOutputRefs:!(T&&c.linearPool)})),T&&c.linearPool&&(A=c.linearPool.wrappedToken,O=I.length-1,E=c.linearPool.linearPoolToken.pool.factory||"",F=c.linearPool.linearPoolToken.pool.address||"",m.push(t.batchRelayerService.getUnwrapCallForLinearPoolWithFactory({poolAddress:F,factory:E,wrappedToken:A.address,sender:t.batchRelayerService.batchRelayerAddress,recipient:i,amount:t.batchRelayerService.toChainedReference(O),outputReference:Z._Y})));case 22:return n.abrupt("return",{type:"BatchRelayer",calls:m});case 23:case"end":return n.stop()}}),n)})))()},t.exitExactBPTInForTokensOutGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c,d,f,m,h,v,k,x,S,b,w,y,g,I,P,A,O,E,F,B,G,_,C,R,W,D,j,q,U,L,z;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(r=[],o=e.amountsOut,a=e.userAddress,i=e.bptAmountIn,u=e.slippage,c=o.map((function(e){return e.address})),d=(0,l.OY)(t.isComposableV1(t.pool)?(0,p.yV)(i,18,u):i,t.pool.tokens,(0,l.kl)(t.pool),t.isStablePool),f=d.filter((function(e){var n;return(null===(n=t.pool.tokens.find((function(e){return"GqlPoolToken"===e.__typename})))||void 0===n?void 0:n.address)===e.address||!c.includes(e.address)})),m=t.pool.tokens.map((function(e,n){return{index:e.index,key:t.batchRelayerService.toChainedReference(n),address:e.address,refIdx:n}})),r.push(t.batchRelayerService.vaultEncodeExitPool({poolId:t.pool.id,poolKind:t.getPoolKind(t.pool),sender:a,recipient:a,exitPoolRequest:t.getExitPoolRequest({pool:t.pool,bptIn:i,exitAmounts:d,finalTokenAmountsOut:o,slippage:u,toInternalBalance:(0,l.r7)(t.pool),inputReference:null}),outputReferences:m})),h=!0,v=!1,k=void 0,n.prev=8,x=function(e,n){var s,i=n.value,d=i.pool,h=f.find((function(e){return e.address===i.address})),v=(0,l.OY)(t.isComposableV1(d)?(0,p.yV)(h.amount,18,u):h.amount,d.tokens.filter((function(e){return e.address!==d.address})),(0,l.kl)(d),!0),k=m[m.length-1].refIdx+1,x=d.tokens.filter((function(e){return e.address!==d.address})).map((function(e,n){return{index:e.index,key:t.batchRelayerService.toChainedReference(k+n),address:e.address,refIdx:k+n}}));r.push(t.batchRelayerService.vaultEncodeExitPool({poolId:d.id,poolKind:t.getPoolKind(d),sender:a,recipient:a,exitPoolRequest:t.getExitPoolRequest({pool:d,bptIn:h.amount,exitAmounts:v,finalTokenAmountsOut:o,slippage:u,toInternalBalance:(0,l.r7)(d),inputReference:(null===(s=m.find((function(e){return e.address===i.address})))||void 0===s?void 0:s.index)||null}),outputReferences:x})),f=f.concat(v.filter((function(e){return!c.includes(e.address)}))),m=(0,T.Z)(m).concat((0,T.Z)(x))},S=t.nestedStablePoolTokens[Symbol.iterator]();!(h=(b=S.next()).done);h=!0)x(0,b);n.next=17;break;case 13:n.prev=13,n.t0=n.catch(8),v=!0,k=n.t0;case 17:n.prev=17,n.prev=18,h||null==S.return||S.return();case 20:if(n.prev=20,!v){n.next=23;break}throw k;case 23:return n.finish(20);case 24:return n.finish(17);case 25:if(!((w=t.nestedLinearPoolTokens.map((function(e){return{linearPoolToken:e,mainToken:(0,l.fK)(e),wrappedToken:(0,l.iK)(e)}}))).length>0)){n.next=71;break}return n.next=29,t.getExitSwapsForNestedLinearPools(f,w);case 29:for(y=n.sent,g=y.swaps,I=y.assets,P=y.deltas,A=y.requiresUnwrap,O=!0,E=!1,F=void 0,n.prev=35,B=function(e,t){var n=t.value,r=m.find((function(e){return e.address===I[n.assetInIndex]}));r&&(n.amount=r.key.toString())},G=g[Symbol.iterator]();!(O=(_=G.next()).done);O=!0)B(0,_);n.next=44;break;case 40:n.prev=40,n.t1=n.catch(35),E=!0,F=n.t1;case 44:n.prev=44,n.prev=45,O||null==G.return||G.return();case 47:if(n.prev=47,!E){n.next=50;break}throw F;case 50:return n.finish(47);case 51:return n.finish(44);case 52:if(r.push(t.batchRelayerService.encodeBatchSwapWithLimits({tokensIn:w.map((function(e){return e.linearPoolToken.address})),tokensOut:w.map((function(e){return A?e.wrappedToken.address:e.mainToken.address})),deltas:P,assets:I,swaps:g,ethAmountScaled:"0",sender:a,recipient:A?t.batchRelayerService.batchRelayerAddress:a,slippage:u,fromInternalBalance:!0,toInternalBalance:!1})),!A){n.next=71;break}for(C=!0,R=!1,W=void 0,n.prev=55,D=w[Symbol.iterator]();!(C=(j=D.next()).done);C=!0)q=j.value,U=q.linearPoolToken.pool.factory||"",L=I.indexOf(q.wrappedToken.address),z=q.linearPoolToken.pool.address||"",r.push(t.batchRelayerService.getUnwrapCallForLinearPoolWithFactory({poolAddress:z,factory:U,wrappedToken:q.wrappedToken.address,sender:t.batchRelayerService.batchRelayerAddress,recipient:a,amount:t.batchRelayerService.toChainedReference(L),outputReference:Z._Y}));n.next=63;break;case 59:n.prev=59,n.t2=n.catch(55),R=!0,W=n.t2;case 63:n.prev=63,n.prev=64,C||null==D.return||D.return();case 66:if(n.prev=66,!R){n.next=69;break}throw W;case 69:return n.finish(66);case 70:return n.finish(63);case 71:return n.abrupt("return",{type:"BatchRelayer",calls:r});case 72:case"end":return n.stop()}}),n,null,[[8,13,17,25],[18,,20,24],[35,40,44,52],[45,,47,51],[55,59,63,71],[64,,66,70]])})))()},t.getExitSwapsForNestedLinearPools=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u,c,p,f,h,v,k,x,S;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(o=[],a=!!t.find((function(t){var n=t.linearPoolToken,r=t.mainToken,o=e.find((function(e){return e.address===n.address}));return parseFloat(r.totalBalance)<parseFloat((null===o||void 0===o?void 0:o.amount)||"0")*parseFloat(n.pool.bptPriceRate)})),i=!0,u=!1,c=void 0,r.prev=3,p=function(t,n){var r=n.value,s=r.linearPoolToken,i=r.mainToken,u=r.wrappedToken,c=e.find((function(e){return e.address===s.address}));c&&o.push({swap:{poolId:s.pool.id,assetInIndex:0,assetOutIndex:1,amount:(0,m.Ox)((null===c||void 0===c?void 0:c.amount)||"0",18).toString(),userData:"0x"},assets:[s.address,a?u.address:i.address],nestedLinearPool:r})},f=t[Symbol.iterator]();!(i=(h=f.next()).done);i=!0)p(0,h);r.next=12;break;case 8:r.prev=8,r.t0=r.catch(3),u=!0,c=r.t0;case 12:r.prev=12,r.prev=13,i||null==f.return||f.return();case 15:if(r.prev=15,!u){r.next=18;break}throw c;case 18:return r.finish(15);case 19:return r.finish(12);case 20:return v=(0,l.Nu)(o.map((function(e){return e.assets})),o.map((function(e){return[e.swap]}))),k=v.swaps,x=v.assets,r.next=23,(0,l.GR)({swapType:d.SwapTypes.SwapExactIn,swaps:k,assets:x,provider:n.provider});case 23:return S=r.sent,r.abrupt("return",{swaps:k,deltas:S,assets:x,requiresUnwrap:a});case 25:case"end":return r.stop()}}),r,null,[[3,8,12,20],[13,,15,19]])})))()},t.buildSingleAssetExit=function(e){var t=e.option,n=e.tokenOption,r=this.pool.tokens.find((function(e){return e.address===t.poolTokenAddress})),o=this.pool.allTokens.find((function(e){return e.address===n.address})),a=this.nestedLinearPoolTokens.find((function(e){return(0,l.fK)(e).address===n.address})),s=this.isStablePool?this.pool:"pool"in r?r.pool:null,i=s?(0,l.Qw)(s,n.address):void 0;return{tokenOut:o,poolToken:r,linearPool:a?{linearPoolToken:a,mainToken:(0,l.fK)(a),wrappedToken:(0,l.iK)(a)}:void 0,exitSwaps:s&&i?I({poolId:s.id,poolAddress:s.address,tokenOut:n.address,bptIn:"0",poolToken:i}):void 0}},t.getAmountOutForBptIn=function(e){var t=e.bptIn,n=e.pool,r=e.poolToken,o=(0,p.zb)((0,f.parseUnits)(t)),a="GqlPoolWeighted"===n.__typename?(0,l.Fe)(n,t,r.address):(0,l.mm)(n,t,r.address),s=[{address:r.address,amount:a}],i="GqlPoolWeighted"===n.__typename?(0,l.Cd)(s,n):(0,l.Ds)(s,n);return{tokenAmountOut:a,priceImpact:o.lt(i)?0:o.div(i).minus(1).toNumber()}},t.getSingleAssetExitForTokenOut=function(e){var t=this.singleAssetExits.find((function(t){return t.tokenOut.address===e}));if(!t)throw new Error("No exit path for token out "+e);return t},t.isComposableV1=function(e){return("GqlPoolComposableStable"===e.__typename||"GqlPoolComposableStableNested"===e.__typename)&&1===e.version},t.getPoolKind=function(e){return this.isComposableV1(e)?E.COMPOSABLE_STABLE:("GqlPoolComposableStable"===e.__typename||"GqlPoolComposableStableNested"===e.__typename)&&e.version>=2?E.COMPOSABLE_STABLE_V2:E.WEIGHTED},t.getExitPoolRequest=function(e){var t=e.pool,n=e.bptIn,r=e.slippage,o=e.exitAmounts,a=(e.finalTokenAmountsOut,e.toInternalBalance),s=e.inputReference,i=null!==s?this.batchRelayerService.toChainedReference(s).toString():(0,f.parseUnits)(n,18).toString(),u=t.tokens.filter((function(e){return e.address!==t.address})),c="GqlPoolWeighted"===t.__typename?(0,B.sortBy)(t.tokens,"index"):(0,B.sortBy)((0,T.Z)(u).concat([{address:t.address,decimals:18,__typename:"pool"}]),"address"),l=(0,B.sortBy)(t.tokens,"index").map((function(e){var t=o.find((function(t){return e.address===t.address}));return(0,f.parseUnits)((null===t||void 0===t?void 0:t.amount)||"0",e.decimals).toString()})),m=o.map((function(e){var n=t.tokens.find((function(t){return t.address===e.address})),o=(0,p.SW)(e.amount,null===n||void 0===n?void 0:n.decimals);return o.minus(o.times(r)).toFixed(0)}));if("GqlPoolComposableStable"===t.__typename||"GqlPoolComposableStableNested"===t.__typename){var h=c.findIndex((function(e){return e.address===t.address}));m.splice(h,0,"0")}return{assets:c.map((function(e){return e.address})),minAmountsOut:this.isComposableV1(t)?c.map((function(){return"0"})):m,userData:this.isComposableV1(t)?z.$.encode(["uint256","uint256[]","uint256"],[1,l,i]):"GqlPoolWeighted"===t.__typename?d.WeightedPoolEncoder.exitExactBPTInForTokensOut(i):z.$.encode(["uint256","uint256"],[2,i]),toInternalBalance:a}},t.getSingleAssetExitSwaps=function(e){var t=e.exit,n=e.tokenOutAddress,o=e.amountIn,a=this;return(0,r.Z)(s().mark((function e(){var r,i,u,c,h,v,k,x,S,b,w,y;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=(0,B.cloneDeep)((null===(r=t.exitSwaps)||void 0===r?void 0:r.swaps)||[]),h=(0,B.cloneDeep)((null===(i=t.exitSwaps)||void 0===i?void 0:i.assets)||[]),v=h.indexOf(n),k=[],x=!1,c[0].amount=(0,f.parseUnits)(o,18).toString(),e.prev=7,e.next=10,(0,l.GR)({provider:a.provider,swaps:c,assets:h,swapType:d.SwapTypes.SwapExactIn});case 10:k=e.sent,e.next=22;break;case 13:if(e.prev=13,e.t0=e.catch(7),t.linearPool){e.next=17;break}throw e.t0;case 17:return h[v]=t.linearPool.wrappedToken.address,e.next=20,(0,l.GR)({provider:a.provider,swaps:c,assets:h,swapType:d.SwapTypes.SwapExactIn});case 20:k=e.sent,x=!0;case 22:return S=x&&t.linearPool?t.linearPool.wrappedToken:t.tokenOut,b=(null===(u=t.linearPool)||void 0===u?void 0:u.wrappedToken.priceRate)||"1.0",w=(0,m.S5)(U.O$.from(k[v]||"0").abs(),S.decimals),y=(0,m.S5)((0,p.cz)(k[v]||"0").abs().times(x?b:"1.0").toFixed(0),t.tokenOut.decimals),e.abrupt("return",{requiresUnwrap:x,deltas:k,tokenAmountOut:w,mainTokenAmountOut:y,swaps:c,assets:h});case 27:case"end":return e.stop()}}),e,null,[[7,13]])})))()},(0,v.Z)(e,[{key:"nestedLinearPoolTokens",get:function(){return(0,l.AO)(this.pool)}},{key:"nestedStablePoolTokens",get:function(){return(0,l.KF)(this.pool)}},{key:"isStablePool",get:function(){return"GqlPoolComposableStable"===this.pool.__typename}},{key:"isWeightedPool",get:function(){return"GqlPoolWeighted"===this.pool.__typename}}]),e}(),J=function(){function e(t,n,r,a){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.wethAddress=r,this.provider=a,this.composableJoinService=new L(t,n,a,r),this.composableExitService=new N(t,n,a,r)}var t=e.prototype;return t.updatePool=function(e){this.pool=e,this.composableJoinService.updatePool(e)},t.joinGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("ExactTokensInForBPTOut"===e.kind){n.next=2;break}throw new Error("unsupported join type");case 2:return n.next=4,t.getJoinData(e.tokenAmountsIn,e.slippage);case 4:return r=n.sent.processedSteps,n.abrupt("return",t.composableJoinService.joinGetContractCallData({data:e,processedSteps:r}));case 6:case"end":return n.stop()}}),n)})))()},t.joinGetBptOutAndPriceImpactForTokensIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getJoinData(e,t);case 2:return o=r.sent,a=o.priceImpact,i=o.minBptReceived,u=o.nestedPriceImpacts,r.abrupt("return",{priceImpact:a,minBptReceived:i,nestedPriceImpacts:u});case 7:case"end":return r.stop()}}),r)})))()},t.getJoinData=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.composableJoinService.processJoinSteps({tokenAmountsIn:e,slippage:t});case 2:return o=r.sent,r.abrupt("return",o);case 4:case"end":return r.stop()}}),r)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.composableExitService.exitGetProportionalWithdrawEstimate(e,t));case 1:case"end":return r.stop()}}),r)})))()},t.exitGetProportionalPoolTokenWithdrawEstimate=function(e){var t=this;return(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.composableExitService.exitGetProportionalPoolTokenWithdrawEstimate(e));case 1:case"end":return n.stop()}}),n)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){var t=this;return(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.composableExitService.exitGetBptInForSingleAssetWithdraw(e));case 1:case"end":return n.stop()}}),n)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.composableExitService.exitGetSingleAssetWithdrawForBptIn(e,t));case 1:case"end":return r.stop()}}),r)})))()},t.exitGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("ExactBPTInForTokensOut"!==e.kind){n.next=4;break}return n.abrupt("return",t.composableExitService.exitExactBPTInForTokensOutGetContractCallData(e));case 4:if("ExactBPTInForOneTokenOut"!==e.kind){n.next=6;break}return n.abrupt("return",t.composableExitService.exitExactBPTInForOneTokenOutGetContractCallData(e));case 6:throw new Error("unsupported join type");case 7:case"end":return n.stop()}}),n)})))()},e}(),M=function(){function e(t,n,r,a){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.wethAddress=r,this.provider=a,this.composableJoinService=new L(t,n,a,r),this.composableExitService=new N(t,n,a,r),this.proportionalInvestService=new _(t)}var t=e.prototype;return t.updatePool=function(e){this.pool=e,this.composableJoinService.updatePool(e),this.proportionalInvestService.updatePool(e)},t.joinGetMaxProportionalForUserBalances=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.proportionalInvestService.getProportionalSuggestion(e);case 2:return r=n.sent,n.next=5,t.joinGetProportionalSuggestionForFixedAmount(r,e.map((function(e){return(0,G.TS)(e.address)})));case 5:return o=n.sent,n.abrupt("return",o);case 7:case"end":return n.stop()}}),n)})))()},t.joinGetProportionalSuggestionForFixedAmount=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u,c;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(0!==parseFloat(e.amount)){r.next=2;break}return r.abrupt("return",t.map((function(e){return{address:e,amount:"0.0"}})));case 2:return o=(0,l.Qw)(n.pool,e.address),r.next=5,n.composableJoinService.processJoinSteps({tokenAmountsIn:[e],slippage:"0"});case 5:if(a=r.sent.processedSteps,i=a.find((function(e){return"Join"===e.type&&e.pool.id===n.pool.id})),u=i.tokenAmountsIn.find((function(e){return e.address===(null===o||void 0===o?void 0:o.address)}))){r.next=10;break}throw new Error("WeightedV2: failed to map fixed amount to pool token fixed amount");case 10:return c=(0,l.Uz)(u,n.pool.tokens),r.abrupt("return",(0,l.fI)({pool:n.pool,nestedTokens:t,poolTokenAmounts:c}));case 12:case"end":return r.stop()}}),r)})))()},t.joinGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("ExactTokensInForBPTOut"===e.kind){n.next=2;break}throw new Error("unsupported join type");case 2:return n.next=4,t.getJoinData(e.tokenAmountsIn,e.slippage);case 4:return r=n.sent.processedSteps,n.abrupt("return",t.composableJoinService.joinGetContractCallData({data:e,processedSteps:r}));case 6:case"end":return n.stop()}}),n)})))()},t.joinGetBptOutAndPriceImpactForTokensIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,i,u;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getJoinData(e,t);case 2:return o=r.sent,a=o.priceImpact,i=o.minBptReceived,u=o.nestedPriceImpacts,r.abrupt("return",{priceImpact:a,minBptReceived:i,nestedPriceImpacts:u});case 7:case"end":return r.stop()}}),r)})))()},t.getJoinData=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.composableJoinService.processJoinSteps({tokenAmountsIn:e,slippage:t});case 2:return o=r.sent,r.abrupt("return",o);case 4:case"end":return r.stop()}}),r)})))()},t.exitGetProportionalPoolTokenWithdrawEstimate=function(e){var t=this;return(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.composableExitService.exitGetProportionalPoolTokenWithdrawEstimate(e));case 1:case"end":return n.stop()}}),n)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.composableExitService.exitGetProportionalWithdrawEstimate(e,t));case 1:case"end":return r.stop()}}),r)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){var t=this;return(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.composableExitService.exitGetBptInForSingleAssetWithdraw(e));case 1:case"end":return n.stop()}}),n)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.composableExitService.exitGetSingleAssetWithdrawForBptIn(e,t));case 1:case"end":return r.stop()}}),r)})))()},t.exitGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("ExactBPTInForTokensOut"!==e.kind){n.next=4;break}return n.abrupt("return",t.composableExitService.exitExactBPTInForTokensOutGetContractCallData(e));case 4:if("ExactBPTInForOneTokenOut"!==e.kind){n.next=6;break}return n.abrupt("return",t.composableExitService.exitExactBPTInForOneTokenOutGetContractCallData(e));case 6:throw new Error("unsupported join type");case 7:case"end":return n.stop()}}),n)})))()},e}(),Y=function(){function e(t,n,r){(0,o.Z)(this,e),this.pool=t,this.batchRelayerService=n,this.wethAddress=r,this.proportionalInvestService=new _(t),this.baseService=new x(t,r)}var t=e.prototype;return t.updatePool=function(e){this.pool=e,this.baseService.updatePool(e),this.proportionalInvestService.updatePool(e)},t.joinGetMaxProportionalForUserBalances=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.proportionalInvestService.getProportionalSuggestion(e);case 2:return r=n.sent,n.next=5,t.joinGetProportionalSuggestionForFixedAmount(r,e.map((function(e){return(0,G.TS)(e.address)})));case 5:return o=n.sent,n.abrupt("return",o);case 7:case"end":return n.stop()}}),n)})))()},t.joinGetProportionalSuggestionForFixedAmount=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.Uz)(e,n.pool.tokens));case 1:case"end":return t.stop()}}),t)})))()},t.joinGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a,i,u,c;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a="minimumBpt"in e?e.minimumBpt:"0",i=t.pool.tokens.map((function(n){return e.wethIsEth?t.baseService.wethToZero(n.address):n.address})),u=(0,l.Xp)(e.maxAmountsIn,t.pool.tokens),c=h.WeightedPoolEncoder.joinAllTokensInForExactBPTOut((0,f.parseUnits)(a)),!("MASTER_CHEF"===(null===(r=t.pool.staking)||void 0===r?void 0:r.type)&&e.zapIntoMasterchefFarm||"GAUGE"===(null===(o=t.pool.staking)||void 0===o?void 0:o.type)&&e.zapIntoGauge)){n.next=7;break}return n.abrupt("return",t.batchRelayerService.encodeJoinPoolAndStake({userData:c,pool:t.pool,assets:i,maxAmountsIn:u,userAddress:e.userAddress}));case 7:return n.abrupt("return",{type:"JoinPool",assets:i,maxAmountsIn:u,userData:c});case 8:case"end":return n.stop()}}),n)})))()},t.joinGetBptOutAndPriceImpactForTokensIn=function(e,t){var n=this;return(0,r.Z)(s().mark((function r(){var o,a,u,c;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=n.pool.tokens.map((function(e){return e.balance})).reduce((function(e,t){return(0,p.cz)(e).plus(t)}),(0,p.cz)(0)),a=n.pool.tokens.map((function(e){return(0,p.cz)(e.balance).div(o).toString()})),!(u=i.v5._calcBptOutGivenExactTokensIn(n.pool.tokens.map((function(e){return(0,p.SW)(e.balance,e.decimals)})),a.map((function(e){return(0,p.SW)(e||"0",18)})),(0,l.g3)(e,n.pool.tokens),(0,p.SW)(n.pool.dynamicData.totalShares),(0,p.SW)(n.pool.dynamicData.swapFee))).lt(0)){r.next=5;break}return r.abrupt("return",{priceImpact:0,minBptReceived:"0"});case 5:return c=u.minus(u.times(t)).toFixed(0),r.abrupt("return",{priceImpact:0,minBptReceived:(0,m.S5)(c.toString(),18)});case 7:case"end":return r.stop()}}),r)})))()},t.exitGetProportionalWithdrawEstimate=function(e,t){var n=this;return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,l.OY)(e,n.pool.tokens,n.pool.dynamicData.totalShares));case 1:case"end":return t.stop()}}),t)})))()},t.exitGetBptInForSingleAssetWithdraw=function(e){return(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{bptIn:"0",priceImpact:0});case 1:case"end":return e.stop()}}),e)})))()},t.exitGetSingleAssetWithdrawForBptIn=function(e,t){return(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{tokenAmount:"0",priceImpact:0});case 1:case"end":return e.stop()}}),e)})))()},t.exitGetContractCallData=function(e){var t=this;return(0,r.Z)(s().mark((function n(){var r,o,a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r="bptAmountIn"in e?e.bptAmountIn:"0",o="amountsOut"in e?e.amountsOut:[],a=o.map((function(n){var r=t.pool.tokens.find((function(e){return e.address===n.address}));return{address:n.address,amount:(0,p.yV)(n.amount,(null===r||void 0===r?void 0:r.decimals)||18,e.slippage)}})),n.abrupt("return",{type:"ExitPool",assets:t.pool.tokens.map((function(e){return e.address})),minAmountsOut:(0,l.Xp)(a,t.pool.tokens),userData:h.WeightedPoolEncoder.exitExactBPTInForTokensOut((0,f.parseUnits)(r))});case 4:case"end":return n.stop()}}),n)})))()},e}();function V(e){return"GqlPoolTokenLinear"===e.__typename||"GqlPoolTokenComposableStable"===e.__typename}function H(e){return"GqlPoolWeighted"===e.__typename&&e.version>=2||"GqlPoolComposableStable"===e.__typename&&e.version>0}function $(e){return"GqlPoolWeighted"===e.__typename&&("HAS_SOME_PHANTOM_BPT"===e.nestingType||"HAS_ONLY_PHANTOM_BPT"===e.nestingType)||H(e)}function K(e){return"GqlPoolWeighted"===e.__typename&&("HAS_SOME_PHANTOM_BPT"===e.nestingType||"HAS_ONLY_PHANTOM_BPT"===e.nestingType)||H(e)}function X(e){switch(e.__typename){case"GqlPoolWeighted":return e.version>=2?new M(e,W.c,D.$.wethAddress,j.fb):"HAS_SOME_PHANTOM_BPT"===e.nestingType||"HAS_ONLY_PHANTOM_BPT"===e.nestingType?new R(e,W.c,D.$.wethAddress,j.fb):new C(e,W.c,D.$.wethAddress);case"GqlPoolStable":return new S(e,W.c,D.$.wethAddress);case"GqlPoolComposableStable":return e.version>0?new J(e,W.c,D.$.wethAddress,j.fb):new F(e,W.c,D.$.wethAddress,j.fb);case"GqlPoolMetaStable":return new q(e,W.c,D.$.wethAddress);case"GqlPoolGyro":return new Y(e,W.c,D.$.wethAddress)}throw new Error("unsupported pool type")}function Q(e){switch(e.__typename){case"GqlPoolWeighted":return"Weighted pool";case"GqlPoolStable":return"Stable pool";case"GqlPoolComposableStable":return"ComposableStable pool";case"GqlPoolLiquidityBootstrapping":return"Liquidity bootstrapping pool";case"GqlPoolMetaStable":return"MetaStable pool";case"GqlPoolGyro":switch(e.type){case"GYRO":return"Gyro 2CLP";case"GYRO3":return"Gyro 3CLP";case"GYROE":return"Gyro ECLP"}default:return"unknown"}}function ee(e){if("GqlPoolLinear"==e.__typename||"GqlPoolLinearNested"===e.__typename){var t=e.tokens.find((function(t){return t.index===e.mainIndex}));return n=e.factory,D.$.balancer.linearFactories.reaper.includes((n||"").toLowerCase())&&t&&t.decimals<18}var n;return!1}function te(e){return("GqlPoolLinear"==e.__typename||"GqlPoolLinearNested"===e.__typename)&&e.tokens.find((function(t){return t.index===e.mainIndex}))||null}},28626:function(e,t,n){n.d(t,{s5:function(){return c},xu:function(){return u}});var r=n(85893),o=n(51797),a=n(30125),s=n(67294),i=(0,s.createContext)(null);function u(e){var t=(0,o.yA)().tokens.map((function(e){return e.address})),n=(0,a.j)(t);return(0,r.jsx)(i.Provider,{value:n,children:e.children})}var c=function(){return(0,s.useContext)(i)}},74590:function(e,t,n){n.d(t,{s:function(){return o},u:function(){return a}});var r=n(828);function o(e){["e","E","+","-"].includes(e.key)&&e.preventDefault()}function a(e,t){if(e.includes(".")){var n=(0,r.Z)(e.split("."),2),o=n[0],a=n[1];if(a&&a.length>t){var s=o.length+t+1;return e.slice(0,s)}}return e}},44860:function(e,t,n){function r(e){var t=e;if(t.reason){var n=t.reason;return-1!==n.indexOf("BAL#507")?"Your transaction failed due to excessive slippage. You can increase your max slippage and try again. BAL#507":-1!==n.indexOf("BAL#506")?"Your transaction failed due to excessive slippage. You can increase your max slippage and try again. BAL#506":-1!==n.indexOf("BAL#505")?"Your transaction failed due to excessive slippage. You can increase your max slippage and try again. BAL#505":"An error occurred: ".concat(n)}return-1!==e.message.indexOf("Connector not found")?"Unable to connect to your wallet. Please ensure your wallet is unlocked and available.":"An error occurred: ".concat(e.message)}n.d(t,{v:function(){return r}})},63979:function(e,t,n){n.d(t,{F:function(){return p}});var r=n(26042),o=n(69396),a=n(99534),s=n(57438),i=n(13510),u=n(44328),c=n(80238);function p(){var e=(0,s.H)(),t=(0,i.q)().userAddress,n=(0,c.q)({abi:u,enabled:!!t,calls:[{address:e.balancer.vault,functionName:"hasApprovedRelayer",args:[t,e.balancer.batchRelayer]}]}),p=n.data,l=(0,a.Z)(n,["data"]);return(0,o.Z)((0,r.Z)({},l),{data:p?p[0]:void 0})}},93287:function(e,t,n){n.d(t,{n2:function(){return G},AI:function(){return _}});var r,o,a=n(26042),s=n(69396),i=n(29815),u=n(85893),c=n(67294),p=n(97382),l=n(19149),d=n(90060),f=n(96486),m=n(57438),h=n(47568),v=n(34051),k=n.n(v),x=n(88767),S=n(69077),b=n(51797),w=n(51438),y=n(69739),T=n(29907),g=JSON.parse('[{"inputs":[{"internalType":"contract IVault","name":"_vault","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address[]","name":"poolAddresses","type":"address[]"}],"name":"getAmpForPools","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"poolAddresses","type":"address[]"}],"name":"getNormalizedWeightsForPools","outputs":[{"internalType":"uint256[][]","name":"","type":"uint256[][]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32[]","name":"poolIds","type":"bytes32[]"},{"components":[{"internalType":"bool","name":"loadTokenBalanceUpdatesAfterBlock","type":"bool"},{"internalType":"bool","name":"loadTotalSupply","type":"bool"},{"internalType":"bool","name":"loadSwapFees","type":"bool"},{"internalType":"bool","name":"loadLinearWrappedTokenRates","type":"bool"},{"internalType":"bool","name":"loadNormalizedWeights","type":"bool"},{"internalType":"bool","name":"loadScalingFactors","type":"bool"},{"internalType":"bool","name":"loadAmps","type":"bool"},{"internalType":"uint256","name":"blockNumber","type":"uint256"},{"internalType":"enum TotalSupplyType[]","name":"totalSupplyTypes","type":"uint8[]"},{"internalType":"enum SwapFeeType[]","name":"swapFeeTypes","type":"uint8[]"},{"internalType":"uint256[]","name":"linearPoolIdxs","type":"uint256[]"},{"internalType":"uint256[]","name":"weightedPoolIdxs","type":"uint256[]"},{"internalType":"uint256[]","name":"scalingFactorPoolIdxs","type":"uint256[]"},{"internalType":"uint256[]","name":"ampPoolIdxs","type":"uint256[]"}],"internalType":"struct SorPoolDataQueryConfig","name":"config","type":"tuple"}],"name":"getPoolData","outputs":[{"internalType":"uint256[][]","name":"balances","type":"uint256[][]"},{"internalType":"uint256[]","name":"totalSupplies","type":"uint256[]"},{"internalType":"uint256[]","name":"swapFees","type":"uint256[]"},{"internalType":"uint256[]","name":"linearWrappedTokenRates","type":"uint256[]"},{"internalType":"uint256[][]","name":"weights","type":"uint256[][]"},{"internalType":"uint256[][]","name":"scalingFactors","type":"uint256[][]"},{"internalType":"uint256[]","name":"amps","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32[]","name":"poolIds","type":"bytes32[]"},{"internalType":"uint256","name":"blockNumber","type":"uint256"}],"name":"getPoolTokenBalancesWithUpdatesAfterBlock","outputs":[{"internalType":"uint256[][]","name":"","type":"uint256[][]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"poolAddresses","type":"address[]"}],"name":"getScalingFactorsForPools","outputs":[{"internalType":"uint256[][]","name":"","type":"uint256[][]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"poolAddresses","type":"address[]"},{"internalType":"enum SwapFeeType[]","name":"swapFeeTypes","type":"uint8[]"}],"name":"getSwapFeePercentageForPools","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"poolAddresses","type":"address[]"},{"internalType":"enum TotalSupplyType[]","name":"totalSupplyTypes","type":"uint8[]"}],"name":"getTotalSupplyForPools","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"poolAddresses","type":"address[]"}],"name":"getWrappedTokenRateForLinearPools","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"vault","outputs":[{"internalType":"contract IVault","name":"","type":"address"}],"stateMutability":"view","type":"function"}]');!function(e){e[e.TOTAL_SUPPLY=0]="TOTAL_SUPPLY",e[e.VIRTUAL_SUPPLY=1]="VIRTUAL_SUPPLY",e[e.ACTUAL_SUPPLY=2]="ACTUAL_SUPPLY"}(r||(r={})),function(e){e[e.SWAP_FEE_PERCENTAGE=0]="SWAP_FEE_PERCENTAGE",e[e.PERCENT_FEE=1]="PERCENT_FEE"}(o||(o={}));var I={loadTokenBalanceUpdatesAfterBlock:!1,loadTotalSupply:!1,loadSwapFees:!1,loadLinearWrappedTokenRates:!1,loadNormalizedWeights:!1,loadScalingFactors:!1,loadAmps:!1,blockNumber:0,totalSupplyTypes:[],swapFeeTypes:[],linearPoolIdxs:[],weightedPoolIdxs:[],scalingFactorPoolIdxs:[],ampPoolIdxs:[]},P=new(function(){function e(t){(0,w.Z)(this,e),this.sorQueriesContractAddress=t}var t=e.prototype;return t.getPoolData=function(e){var t=e.poolIds,n=e.provider,r=e.config,o=this;return(0,h.Z)(k().mark((function e(){var s,i;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new y.Contract(o.sorQueriesContractAddress,g,n),e.next=3,s.getPoolData(t,(0,a.Z)({},I,r));case 3:return i=e.sent,e.abrupt("return",{balances:i[0],totalSupplies:i[1],swapFees:i[2],linearWrappedTokenRates:i[3],weights:i[4],scalingFactors:i[5],amps:i[6]});case 5:case"end":return e.stop()}}),e)})))()},t.getTotalSupplyType=function(e){var t=["GqlPoolComposableStable","GqlPoolComposableStableNested"].includes(e.__typename);return"GqlPoolWeighted"===e.__typename&&e.version>=2||t&&e.version>0?r.ACTUAL_SUPPLY:t&&0===e.version||["GqlPoolLinear","GqlPoolLinearNested"].includes(e.__typename)?r.VIRTUAL_SUPPLY:r.TOTAL_SUPPLY},e}())(T.$.balancer.sorQueries),A=n(20335),O=n(27454),E=function(){function e(t){(0,w.Z)(this,e),this.sorQueryService=t}var t=e.prototype;return t.updatePoolWithOnChainBalanceData=function(e){var t=e.pool,n=e.provider,r=e.tokenPrices,o=this;return(0,h.Z)(k().mark((function e(){var a,s,i,u,c,p,l,d,m,h,v,x,S,b,w,y,T,g,I,P,E,F,B,G,_,C,Z,R;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getBalanceDataForPool({pool:t,provider:n});case 2:a=e.sent,s=(0,f.keyBy)(a,"poolId"),i=(0,f.keyBy)(r,"address"),(u=(0,f.cloneDeep)(t)).dynamicData.totalShares=(0,A.S5)(s[t.id].totalSupply,18),c=!0,p=!1,l=void 0,e.prev=8,d=u.tokens[Symbol.iterator]();case 10:if(c=(m=d.next()).done){e.next=67;break}if("GqlPoolTokenLinear"!==(h=m.value).__typename&&"GqlPoolTokenComposableStable"!==h.__typename||(h.pool.totalShares=(0,A.S5)(s[h.pool.id].totalSupply,18)),v=(0,A.S5)(s[t.id].balances[h.index],h.decimals),h.balance=v,h.totalBalance=v,"GqlPoolTokenLinear"!==h.__typename&&"GqlPoolTokenComposableStable"!==h.__typename){e.next=64;break}x=parseFloat(v)/parseFloat((0,A.S5)(s[h.pool.id].totalSupply,18)),S=!0,b=!1,w=void 0,e.prev=19,y=h.pool.tokens[Symbol.iterator]();case 21:if(S=(T=y.next()).done){e.next=50;break}if(g=T.value,I=(0,A.S5)(s[h.pool.id].balances[g.index],g.decimals),g.balance=(0,A.S5)((0,O.zb)(s[h.pool.id].balances[g.index]).times(x).toFixed(0).toString(),g.decimals),g.totalBalance=I,"GqlPoolTokenLinear"!==g.__typename){e.next=47;break}for(P=(0,A.S5)(s[g.pool.id].totalSupply,18),g.pool.totalShares=P,E=parseFloat(I)/parseFloat(P),F=!0,B=!1,G=void 0,e.prev=31,_=g.pool.tokens[Symbol.iterator]();!(F=(C=_.next()).done);F=!0)Z=C.value,R=s[g.pool.id].balances[Z.index],Z.balance=(0,A.S5)((0,O.zb)(R).times(x).times(E).toFixed(0).toString(),Z.decimals),Z.totalBalance=(0,A.S5)(R,Z.decimals);e.next=39;break;case 35:e.prev=35,e.t0=e.catch(31),B=!0,G=e.t0;case 39:e.prev=39,e.prev=40,F||null==_.return||_.return();case 42:if(e.prev=42,!B){e.next=45;break}throw G;case 45:return e.finish(42);case 46:return e.finish(39);case 47:S=!0,e.next=21;break;case 50:e.next=56;break;case 52:e.prev=52,e.t1=e.catch(19),b=!0,w=e.t1;case 56:e.prev=56,e.prev=57,S||null==y.return||y.return();case 59:if(e.prev=59,!b){e.next=62;break}throw w;case 62:return e.finish(59);case 63:return e.finish(56);case 64:c=!0,e.next=10;break;case 67:e.next=73;break;case 69:e.prev=69,e.t2=e.catch(8),p=!0,l=e.t2;case 73:e.prev=73,e.prev=74,c||null==d.return||d.return();case 76:if(e.prev=76,!p){e.next=79;break}throw l;case 79:return e.finish(76);case 80:return e.finish(73);case 81:return u.dynamicData.totalLiquidity=(0,f.sumBy)(u.tokens.map((function(e){return i[e.address].price*parseFloat(e.balance)}))).toString(),e.abrupt("return",u);case 83:case"end":return e.stop()}}),e,null,[[8,69,73,81],[19,52,56,64],[31,35,39,47],[40,,42,46],[57,,59,63],[74,,76,80]])})))()},t.getBalanceDataForPool=function(e){var t=e.pool,n=e.provider,r=this;return(0,h.Z)(k().mark((function e(){var o,a,s,i,u,c,p,l,d,f,m,h,v,x,S,b,w;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=[t.id],a=[r.sorQueryService.getTotalSupplyType(t)],s=!0,i=!1,u=void 0,e.prev=3,c=t.tokens[Symbol.iterator]();case 5:if(s=(p=c.next()).done){e.next=29;break}if("GqlPoolTokenLinear"!==(l=p.value).__typename&&"GqlPoolTokenComposableStable"!==l.__typename||(o.push(l.pool.id),a.push(r.sorQueryService.getTotalSupplyType(l.pool))),"GqlPoolTokenComposableStable"!==l.__typename){e.next=26;break}for(d=!0,f=!1,m=void 0,e.prev=10,h=l.pool.tokens[Symbol.iterator]();!(d=(v=h.next()).done);d=!0)"GqlPoolTokenLinear"===(x=v.value).__typename&&(o.push(x.pool.id),a.push(r.sorQueryService.getTotalSupplyType(x.pool)));e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),f=!0,m=e.t0;case 18:e.prev=18,e.prev=19,d||null==h.return||h.return();case 21:if(e.prev=21,!f){e.next=24;break}throw m;case 24:return e.finish(21);case 25:return e.finish(18);case 26:s=!0,e.next=5;break;case 29:e.next=35;break;case 31:e.prev=31,e.t1=e.catch(3),i=!0,u=e.t1;case 35:e.prev=35,e.prev=36,s||null==c.return||c.return();case 38:if(e.prev=38,!i){e.next=41;break}throw u;case 41:return e.finish(38);case 42:return e.finish(35);case 43:return e.next=45,r.sorQueryService.getPoolData({poolIds:o,provider:n,config:{loadTokenBalanceUpdatesAfterBlock:!0,blockNumber:0,loadTotalSupply:!0,totalSupplyTypes:a}});case 45:return S=e.sent,b=S.balances,w=S.totalSupplies,e.abrupt("return",o.map((function(e,t){return{poolId:e,balances:b[t],totalSupply:w[t]}})));case 49:case"end":return e.stop()}}),e,null,[[3,31,35,43],[10,14,18,26],[19,,21,25],[36,,38,42]])})))()},e}(),F=new E(P);var B=(0,c.createContext)(null);function G(e){var t,n,r=e.pool,o=e.children,v=(0,m.H)(),w=(0,p.Jy)({variables:{id:r.id},notifyOnNetworkStatusChange:!0}),y=w.data,T=w.networkStatus,g=w.startPolling,I=w.refetch,P=(null===y||void 0===y?void 0:y.pool)||r;P=(0,s.Z)((0,a.Z)({},P),{tokens:P.tokens.filter((function(e){return e.address!==P.address}))});var A=(0,c.useMemo)((function(){if(P.address!==v.reliquary.fbeets.poolAddress)return null;var e=P.investConfig.options.findIndex((function(e){return e.poolTokenAddress.toLowerCase()===v.wethAddress})),t=P.investConfig.options[e].tokenOptions.filter((function(e){return e.address.toLowerCase()!==v.eth.address.toLowerCase()}));return(0,s.Z)((0,a.Z)({},P),{investConfig:(0,s.Z)((0,a.Z)({},P.investConfig),{options:[(0,s.Z)((0,a.Z)({},P.investConfig.options[e]),{tokenOptions:t})].concat((0,i.Z)(P.investConfig.options.filter((function(t,n){return n!==e}))))})})}),[P.address]),O=(0,l.Zs)(P),E=function(e){var t=(0,S.yL)(),n=(0,b.yA)().priceFor,r=e.tokens.map((function(e){return{address:e.address,price:n(e.address)}}));return(0,x.useQuery)(["usePoolWithOnChainData",e.id,r],(0,h.Z)(k().mark((function n(){return k().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",F.updatePoolWithOnChainBalanceData({pool:e,provider:t,tokenPrices:r}));case 1:case"end":return n.stop()}}),n)}))))}(P),G=E.data,_={address:(P=G||P).address,symbol:P.symbol,name:P.name,decimals:P.decimals},C=parseFloat(P.dynamicData.totalLiquidity)/parseFloat(P.dynamicData.totalShares),Z=(0,l.ry)(P),R=(0,l.Cl)(P),W=(0,l.R7)(P),D=("GqlPoolWeighted"===P.__typename||"GqlPoolStable"===P.__typename||"GqlPoolMetaStable"===P.__typename||"GqlPoolComposableStable"===P.__typename&&0===P.version)&&"MASTER_CHEF"===(null===(t=P.staking)||void 0===t?void 0:t.type)&&!!P.staking.farm,j=("GqlPoolWeighted"===P.__typename&&P.version>=2||"GqlPoolComposableStable"===P.__typename||"GqlPoolMetaStable"===P.__typename||"GqlPoolGyro"===P.__typename)&&"GAUGE"===(null===(n=P.staking)||void 0===n?void 0:n.type)&&!!P.staking.gauge,q=D||j,U=(0,c.useMemo)((function(){return(0,f.uniqBy)((0,i.Z)(P.allTokens).concat([_],(0,i.Z)(P.investConfig.options.flatMap((function(e){return e.tokenOptions}))),(0,i.Z)(P.withdrawConfig.options.flatMap((function(e){return e.tokenOptions})))),"address")}),[P.id]),L="GqlPoolStable"===P.__typename||"GqlPoolComposableStable"===P.__typename||"GqlPoolMetaStable"===P.__typename,z="GqlPoolAprRange"===P.dynamicData.apr.apr.__typename?parseFloat(P.dynamicData.apr.apr.max):parseFloat(P.dynamicData.apr.apr.total),N="GqlPoolGyro"!==P.__typename;return(0,d.qR)((function(){I(),g(3e4)})),(0,c.useEffect)((function(){O.updatePool(P)}),[T]),(0,u.jsx)(B.Provider,{value:{pool:null!==A&&void 0!==A?A:P,poolService:O,bpt:_,allTokens:U,allTokenAddresses:U.map((function(e){return e.address})),requiresBatchRelayerOnJoin:R,requiresBatchRelayerOnExit:W,bptPrice:C,supportsZap:q,formattedTypeName:(0,l.tf)(P),totalApr:z,isFbeetsPool:P.id===v.fbeets.poolId,isStablePool:L,isComposablePool:Z,canCustomInvest:N},children:o})}function _(){return(0,c.useContext)(B)}},17681:function(e,t,n){n.d(t,{pt:function(){return m},yT:function(){return f}});var r=n(26042),o=n(69396),a=n(99534),s=n(85893),i=n(30125),u=n(96486),c=n(51797),p=n(93287),l=n(67294);var d=(0,l.createContext)(null);function f(e){var t=function(){var e=(0,c.yA)().priceForAmount,t=(0,p.AI)(),n=t.allTokens,s=t.allTokenAddresses,l=t.pool,d=(0,i.j)(s,n),f=d.userBalances,m=d.getUserBalance,h=(0,a.Z)(d,["userBalances","getUserBalance"]),v=l.investConfig.options.map((function(e){return e.tokenOptions})).flat(),k=(0,u.sumBy)(v,(function(t){return e({address:t.address,amount:m(t.address)})})),x=l.investConfig.options.filter((function(e){return e.tokenOptions.length>1})).map((function(e){var t=(0,u.orderBy)(e.tokenOptions,(function(e){return parseFloat(m(e.address))}),"desc")[0];return{poolTokenIndex:e.poolTokenIndex,tokenAddress:t.address}}));return(0,o.Z)((0,r.Z)({},h),{userPoolTokenBalances:f,investableAmount:k,getUserBalanceForToken:function(e){var t;return(null===(t=f.find((function(t){return e===t.address})))||void 0===t?void 0:t.amount)||"0"},optionsWithLargestBalances:x})}();return(0,s.jsx)(d.Provider,{value:t,children:e.children})}function m(){return(0,l.useContext)(d)}}}]);
//# sourceMappingURL=8959-0b87b3550b8c5375.js.map