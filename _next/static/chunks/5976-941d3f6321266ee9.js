"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5976],{22312:function(e,n,t){t.d(n,{b:function(){return w}});var i=t(14924),r=t(26042),o=t(69396),a=t(85893),s=t(67294),u=t(10679),d=t(48641),l=t(49511),c=t(47741),f=t(3038),m=t(57174),g=t(80016),p=t(31062),v=t(44860),h=t(47300),b=t(63979),x=t(99534),k=t(27605),y=t(57438),T=t(59305);function S(e){var n=e.buttonText,t=(0,x.Z)(e,["buttonText"]),i=function(){var e=(0,y.H)(),n=(0,k.lC)({config:{addressOrName:e.gauge.balancerPseudoMinterAddress,contractInterface:T,functionName:"setMinterApproval"},transactionType:"APPROVE"}),t=n.submit,i=(n.submitAsync,(0,x.Z)(n,["submit","submitAsync"]));return(0,r.Z)({approve:function(){t({args:[e.balancer.batchRelayer,!0],toastText:"Approve batch relayer for minting"})}},i)}(),s=i.approve,u=(0,x.Z)(i,["approve"]);return(0,a.jsx)(g.H,(0,o.Z)((0,r.Z)((0,o.Z)((0,r.Z)({},u),{width:"full",onClick:function(){s()}}),t),{borderColor:"beets.green",_focus:{boxShadow:"none"},submittingText:"Confirm...",pendingText:"Waiting...",children:n||"Approve Batch Relayer for minting"}))}var C=t(13510),Z=t(80238);function w(e){var n=e.isLoading,t=e.loadingButtonText,k=e.completeButtonText,w=e.onCompleteButtonClick,A=e.steps,F=e.onSubmit,j=e.onConfirmed,P=e.onComplete,V=e.queries,E=e.isDisabled,L=e.buttonSize,M=void 0===L?"lg":L,N=function(e,n){W((0,o.Z)((0,r.Z)({},$),(0,i.Z)({},e,n)))},B=function(){if(_){var e;if(A[I+1])W((0,o.Z)((0,r.Z)({},$),(e={},(0,i.Z)(e,_.id,"complete"),(0,i.Z)(e,A[I+1].id,"current"),e)));else N(_.id,"complete");j(_.id),I===A.length-1&&U(!0),A[I+1]&&q(I+1)}},O=(0,s.useState)(0),I=O[0],q=O[1],z=(0,s.useState)({}),$=z[0],W=z[1],_=A?A[I]:null,R=V.find((function(e){return e.id===(null===_||void 0===_?void 0:_.id)})),H=(0,s.useState)(!1),D=H[0],U=H[1],X=(0,b.F)(),G=X.refetch,K=(X.data,function(){var e=(0,y.H)(),n=(0,C.q)().userAddress,t=(0,Z.q)({abi:T,enabled:!!n&&e.gaugeEnabled,calls:[{address:e.gauge.balancerPseudoMinterAddress,functionName:"getMinterApproval",args:[e.balancer.batchRelayer,n]}]}),i=t.data,a=(0,x.Z)(t,["data"]);return(0,o.Z)((0,r.Z)({},a),{data:i?i[0]:void 0})}().refetch);return(0,s.useEffect)((function(){D&&P&&P()}),[D]),(0,a.jsxs)(d.xu,{width:"full",children:[n&&!D?(0,a.jsx)(d.kC,{justifyContent:"center",mb:"6",children:(0,a.jsx)(l.Od,{height:"30px",width:"180px"})}):A&&A.length>1?(0,a.jsx)(u.G,{mb:"6",steps:A.map((function(e){return(0,o.Z)((0,r.Z)({},e),{status:$[e.id]||"idle"})}))}):null,n&&!D?(0,a.jsx)(c.zx,{variant:"primary",isLoading:!0,loadingText:t,width:"full",size:M,children:t}):null,A&&_&&"batch-relayer"===_.id&&!D?(0,a.jsx)(h.W,{onSubmitting:function(){return N(_.id,"submitting")},onPending:function(){return N(_.id,"pending")},onCanceled:function(){return N(_.id,"current")},onConfirmed:function(){G(),B()},buttonText:_.buttonText}):null,A&&_&&"minter"===_.id&&!D?(0,a.jsx)(S,{onSubmitting:function(){return N(_.id,"submitting")},onPending:function(){return N(_.id,"pending")},onCanceled:function(){return N(_.id,"current")},onConfirmed:function(){K(),B()},buttonText:_.buttonText}):null,A&&_&&"tokenApproval"===_.type&&!D?(0,a.jsx)(p.X,{tokenWithAmount:_.token,contractToApprove:_.contractToApprove,onConfirmed:B,onSubmitting:function(){return N(_.id,"submitting")},onPending:function(){return N(_.id,"pending")},onCanceled:function(){return N(_.id,"current")},isDisabled:E,size:M}):null,!n&&_&&"tokenApproval"!==_.type&&R&&!D?(0,a.jsx)(g.H,(0,o.Z)((0,r.Z)({},R),{width:"full",onClick:function(){return F(_.id)},onSubmitting:function(){return N(_.id,"submitting")},onPending:function(){return N(_.id,"pending")},onCanceled:function(){return N(_.id,"current")},onConfirmed:B,isDisabled:E,size:M,children:_.buttonText})):null,D&&(0,a.jsx)(c.zx,{onClick:function(){W({}),U(!1),w()},width:"full",variant:"outline",size:M,children:k}),R&&R.submitError?(0,a.jsxs)(f.bZ,{status:"error",mt:4,children:[(0,a.jsx)(f.zM,{}),(0,v.v)(R.submitError)]}):null,D&&(0,a.jsx)(m.h_,{children:(0,a.jsx)(d.xu,{position:"absolute",top:"0",left:"0",width:"full",children:(0,a.jsxs)("div",{className:"fireworks",children:[(0,a.jsx)("div",{className:"before"}),(0,a.jsx)("div",{className:"after"})]})})})]})}},37836:function(e,n,t){t.d(n,{$:function(){return h},Z:function(){return b}});var i=t(26042),r=t(69396),o=t(29815),a=t(85893),s=t(69407),u=t(56371),d=t(96486),l=t(67294),c=t(29907),f=t(51797),m=t(28626),g=[{type:"weighted",isEnabled:!0,name:"Weighted Pool"}],p=["0.1","0.3","1"],v=l.createContext(null),h=function(){return(0,l.useContext)(v)};function b(e){var n=e.children,t=function(){var e=function(e){B(e),null!==e&&localStorage.setItem("poolCreation.experience",e)},n=function(){var e=(0,o.Z)(ce).concat([{address:"",amount:null,weight:0,isLocked:!1}]);fe(e),x(e)},t=function(e){var n=ce.filter((function(n,t){return t!==e}));fe(n),x(n)},a=function(e){var n=ce.filter((function(n){return n.address!==e}));fe(n),x(n)},v=function(){var e=!0,n=ce.map((function(n){var t=Math.round(n.weight),i=F(n.address);return i||(e=!1),i?"".concat(Math.round(t)).concat(i.symbol):""}));return e?n.join("-"):""},h=function(e){var n=ce.map((function(n,t){return t===e?(0,r.Z)((0,i.Z)({},n),{isLocked:!n.isLocked}):n}));fe(n),x(n)},b=function(e){var n=ce.map((function(n){return n.address===e?(0,r.Z)((0,i.Z)({},n),{isLocked:!n.isLocked}):n}));fe(n),x(n)},x=function(e){var n=parseFloat((0,d.sum)(e.filter((function(e){return e.isLocked})).map((function(e){return e.weight/100}))).toFixed(4));n>1&&(n=1);var t=(0,s.bnum)((0,s.bnum)(1).minus(n)),a=e.filter((function(e){return!e.isLocked})),u=t.div(a.length),l=t.minus(u.times(a.length)),c=l.mod(a.length).eq(0),f=c?l.div(a.length):l,m=a.map((function(e,n){var t=Number(u.toFixed(4)),i=1e14*Number(f.toString());return c||0!==n?c?t+i:t:t+i})),g=a.map((function(e,n){return(0,r.Z)((0,i.Z)({},e),{weight:Number((100*m[n]).toFixed(2))||0})})),p=(0,o.Z)(e.filter((function(e){return e.isLocked}))).concat((0,o.Z)(g));fe(p)},k=function(e){var n={},t=!0,i=!1,r=void 0;try{for(var o,a=ce[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var u=o.value,d=(0,s.bnum)(j(u.address)),l=e.times(u.weight),c=l.div(d);n[u.address]={liquidityRequired:l.toString(),balanceRequired:c.toString()}}}catch(f){i=!0,r=f}finally{try{t||null==a.return||a.return()}finally{if(i)throw r}}return n},y=function(){var e;if(!ce.length)return{};var n=ce.filter((function(e){return""!==(null===e||void 0===e?void 0:e.address)})),t={};if(!n.length)return{};var i=n[0],r=(0,s.bnum)(P(n[0].address)).times(j(n[0].address)),o=!0,a=!1,u=void 0;try{for(var d,l=n[Symbol.iterator]();!(o=(d=l.next()).done);o=!0){var c=d.value,f=(0,s.bnum)(P(c.address)).times(j(c.address));f.lt(r)&&(r=f,i=c)}}catch(v){a=!0,u=v}finally{try{o||null==l.return||l.return()}finally{if(a)throw u}}var m=(null===(e=ce.find((function(e){return e.address===i.address})))||void 0===e?void 0:e.weight)||0,g=j(i.address);if(!i)return t;var p=(0,s.bnum)(g).times(P(i.address)).div(m);return k(p)},T=function(){var e=(0,d.sumBy)(ce,(function(e){return e.weight})),n=ce.every((function(e){return(0,u.isAddress)(e.address)}))&&ce.length>=2,t=ce.some((function(e){return e.weight<1})),i=(0,d.sumBy)(ce,(function(e){return j(e.address)*parseFloat(e.amount||"0")})),r=ce.every((function(e){return null!==e.amount&&parseFloat(e.amount||"0")>0})),o=ce.some((function(e){return parseFloat(e.amount||"0")>parseFloat(P(e.address))})),a=i>100;return{areTokenSelectionsValid:n,hasInvalidTokenWeights:t,invalidTotalWeight:100!==e,hasMoreThanMaxTotalLiquidity:a,areTokenAmountsValid:r,hasInsufficientBalances:o,isValid:100===e&&n&&!t&&!a&&!o&&r}},S=function(){var e=parseFloat(I)<=1;$&&(e=parseFloat(I)<=10);var n=null===I||""===I||isNaN(parseFloat(I)),t=0===parseFloat(I);return{isFeeEmpty:n,isFeeZero:t,isFeeValid:e,isValid:!n&&!t&&e}},C=function(){return(0,u.isAddress)(R||"")},Z=function(){return""!=K},w=function(){L("choose-tokens"),q(p[1]),W(!1),H(c.$.beetsPoolOwnerAddress),X("dao-managed"),J(void 0),ee(void 0),ie(-1),ae(null),de(!1),fe([{address:c.$.beets.address,amount:null,isLocked:!1,weight:50},{address:c.$.balancer.balToken,amount:null,isLocked:!1,weight:50}])},A=(0,f.yA)(),F=A.getToken,j=A.priceFor,P=(0,m.s5)().getUserBalance,V=(0,l.useState)("choose-tokens"),E=V[0],L=V[1],M=(0,l.useState)("advanced"),N=M[0],B=M[1],O=(0,l.useState)(p[1]),I=O[0],q=O[1],z=(0,l.useState)(!1),$=z[0],W=z[1],_=(0,l.useState)(c.$.beetsPoolOwnerAddress),R=_[0],H=_[1],D=(0,l.useState)("dao-managed"),U=D[0],X=D[1],G=(0,l.useState)(),K=G[0],J=G[1],Q=(0,l.useState)(),Y=Q[0],ee=Q[1],ne=(0,l.useState)(-1),te=ne[0],ie=ne[1],re=(0,l.useState)(null),oe=re[0],ae=re[1],se=(0,l.useState)(!1),ue=se[0],de=se[1],le=(0,l.useState)([{address:c.$.beets.address,amount:null,isLocked:!1,weight:50},{address:"OPTIMISM"===c.$.chainName?c.$.balancer.balToken:c.$.wethAddress,amount:null,isLocked:!1,weight:50}]),ce=le[0],fe=le[1];return(0,l.useEffect)((function(){J(v())}),[ce]),(0,l.useEffect)((function(){T().isValid?(ie(0),T().isValid&&S().isValid?(ie(1),T().isValid&&S().isValid&&C()?(ie(2),T().isValid&&S().isValid&&C()&&Z()?ie(4):ie(3)):ie(1)):ie(0)):ie(-1)}),[ce,I,R,K]),{activeStep:E,creationExperience:N,poolTypes:g,tokens:ce,MAX_TOKENS:8,FEE_PRESETS:p,isUsingCustomFee:$,currentFee:I,feeManager:R,managerOption:U,otherManagerOption:Y,poolName:K,progressValidatedTo:te,poolId:oe,isCreationComplete:ue,resetPoolCreationState:w,setIsCreationComplete:de,setPoolId:ae,isFeeManagerValid:C,getTokenAndWeightValidations:T,isPoolNameValid:Z,getPoolFeeValidations:S,setProgressValidatedTo:ie,setPoolName:J,setOtherManagerOption:ee,setManagerOption:X,setFeeManager:H,setCurrentFee:q,setIsUsingCustomFee:W,setActiveStep:L,setCreationExperience:e,addBlankToken:n,removeTokenByAddress:a,removeTokenByIndex:t,setTokens:fe,distributeTokenWeights:x,toggleLockTokenByAddress:b,toggleLockTokenByIndex:h,getPoolSymbol:v,getOptimizedLiquidity:y}}();return(0,a.jsx)(v.Provider,{value:t,children:n})}}}]);
//# sourceMappingURL=5976-941d3f6321266ee9.js.map